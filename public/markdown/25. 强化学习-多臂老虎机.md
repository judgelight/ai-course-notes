---
marp: true
theme: default
paginate: true
math: katex
---

<style>
section {
  font-family: "Microsoft YaHei", "PingFang SC", "Source Han Sans", "Noto Sans CJK SC", sans-serif;
}
</style>

# <!-- fit -->ğŸ“˜ ç¬¬25è®²ï¼šå¼ºåŒ–å­¦ä¹ -å¤šè‡‚è€è™æœºï¼ˆTransformer Modelï¼‰

---

# 1. å¤šè‡‚è€è™æœºæ˜¯ä»€ä¹ˆï¼Ÿ

ç»å…¸æƒ³è±¡ï¼š

* æœ‰ **K å°è€è™æœº**ï¼Œæ¯å°æœºå­çš„ä¸­å¥–æ¦‚ç‡éƒ½ä¸ä¸€æ ·ï¼Œä½†ä½ **ä¸çŸ¥é“**ã€‚
* æ¯ä¸€è½®ä½ å¯ä»¥é€‰æ‹©æ‹‰ä¸€å°æœºå­çš„æ†ä¸€æ¬¡ï¼Œå¾—åˆ°ä¸€ä¸ªå¥–åŠ±ï¼ˆä¾‹å¦‚ 1 å…ƒ æˆ– 0 å…ƒï¼‰ã€‚
* ç›®æ ‡ï¼šåœ¨æœ‰é™çš„$T$è½®é‡Œï¼Œè®©**æ€»å¥–åŠ±å°½å¯èƒ½å¤§**ã€‚

é‡è¦å‡è®¾ï¼ˆæœ€åŸºç¡€ç‰ˆæœ¬ï¼‰ï¼š

* æ¯å°æœºå­çš„ä¸­å¥–æ¦‚ç‡$p_a$æ˜¯ **å›ºå®šä¸å˜çš„**ï¼ˆstationaryï¼‰
  ä¸ä¼šéšç€æ—¶é—´æˆ–æ¬¡æ•°è€Œå˜åŒ–ã€‚
* ä½ ä¸çŸ¥é“è¿™äº›$p_a$ï¼Œåªèƒ½é€šè¿‡æ‹‰æ†è§‚å¯Ÿä¸­å¥–/ä¸ä¸­å¥–æ¥â€œä¼°è®¡â€ã€‚

---

å¦‚æœä½ çŸ¥é“æ‰€æœ‰$p_a$ï¼Œé‚£é—®é¢˜å°±å˜æˆï¼š

> **é€‰ä¸­å¥–æ¦‚ç‡æœ€å¤§çš„é‚£å°æœºå­ï¼Œä¸€ç›´æ‹‰å°±è¡Œäº†ã€‚**

ä½†ç°å®æ˜¯ï¼šä½ ä¸çŸ¥é“ï¼Œåªèƒ½è¾¹è¯•è¾¹å­¦ã€è¾¹å­¦è¾¹èµšã€‚
è¿™å°±æ˜¯å¼ºåŒ–å­¦ä¹ ä¸­æœ€ç®€åŒ–çš„ä¸€ç±»é—®é¢˜ã€‚

---

# 2. æ•°å­¦å½¢å¼åŒ–ï¼šå¤šè‡‚è€è™æœºçš„å®šä¹‰

* è‡‚é›†åˆï¼ˆåŠ¨ä½œé›†åˆï¼‰ï¼š
$$
  \mathcal{A} = {1, 2, \dots, K}
$$
* æ¯ä¸ªè‡‚$a$æœ‰ä¸€ä¸ªå›ºå®šä½†æœªçŸ¥çš„ä¸­å¥–æ¦‚ç‡$p_a$
* ç¬¬$t$æ­¥ï¼Œé€‰æ‹©è‡‚$a_t$ï¼Œè·å¾—å¥–åŠ±ï¼š
$$
  R_t \in {0,1},\quad R_t \sim \text{Bernoulli}(p_{a_t})
$$

---

ç›®æ ‡ä¸€èˆ¬å†™ä½œï¼šæœ€å¤§åŒ–æœŸæœ›æ€»å¥–åŠ±
$$
\mathbb{E}\left[\sum_{t=1}^T R_t\right]
$$

ç­‰ä»·çš„è¯´æ³•ï¼šæœ€å°åŒ–**é—æ†¾ï¼ˆregretï¼‰**ï¼š
â€œæ€»æ˜¯é€‰æœ€ä¼˜è‡‚èƒ½è·å¾—çš„å¥–åŠ±â€ - â€œå®é™…å¥–åŠ±â€ã€‚

---

# 3. æ ¸å¿ƒçŸ›ç›¾ï¼šæ¢ç´¢ vs åˆ©ç”¨ï¼ˆexploration vs exploitationï¼‰

è¿™éƒ¨åˆ†æ˜¯ç†è§£æ•´ä¸ª RL çš„å…³é”®ã€‚

* **åˆ©ç”¨ï¼ˆExploitationï¼‰**ï¼š
  æ ¹æ®**å½“å‰çš„ä¼°è®¡**ï¼Œé€‰æ‹©çœ‹èµ·æ¥æœ€å¥½çš„é‚£å°æœºå­ â†’ èµšâ€œçœ¼å‰é’±â€

* **æ¢ç´¢ï¼ˆExplorationï¼‰**ï¼š
  å»å°è¯•ä¸é‚£ä¹ˆç¡®å®šçš„æœºå­ï¼Œè·å–ä¿¡æ¯ â†’ æœ‰å¯èƒ½å‘ç°æ›´å¥½çš„é€‰é¡¹

---

çŸ›ç›¾ç‚¹ï¼š

* å¦‚æœä½ åªåˆ©ç”¨ï¼ˆä¸€ç›´ç”¨å½“å‰æœ€å¥½ï¼‰ï¼š
  â†’ ä¸€æ—¦æ—©æœŸåˆ¤æ–­é”™äº†ï¼Œå°±ä¼šä¸€ç›´ç”¨é”™è¯¯çš„æœºå­ï¼Œé•¿æœŸæŸå¤±å¾ˆå¤§ã€‚
* å¦‚æœä½ åªæ¢ç´¢ï¼ˆåˆ°å¤„ä¹±è¯•ï¼‰ï¼š
  â†’ ä¿¡æ¯å¾ˆå¤šï¼Œä½†é’±èµšå¾—å¾ˆå°‘ã€‚

**å¤šè‡‚è€è™æœº = ç ”ç©¶å¦‚ä½•å¹³è¡¡æ¢ç´¢å’Œåˆ©ç”¨ã€‚**

---

# 4. æœ´ç´ ç­–ç•¥ï¼šå…ˆå„è¯• N æ¬¡ï¼Œå†é€‰çœ‹èµ·æ¥æœ€å¥½çš„

ä¸€ä¸ªè‡ªç„¶ä½†â€œæœ‰å‘â€çš„æƒ³æ³•ï¼š

1. å…ˆæ¯å°æœºå­éƒ½è¯•$N$æ¬¡ï¼ˆçº¯æ¢ç´¢ï¼‰
2. ç®—æ¯å°æœºå­çš„å¹³å‡ä¸­å¥–ç‡
3. åé¢çš„æ—¶é—´å…¨ç”¨å¹³å‡ä¸­å¥–ç‡æœ€é«˜çš„é‚£å°ï¼ˆçº¯åˆ©ç”¨ï¼‰

---

é—®é¢˜å‡ºåœ¨ï¼š

### é—®é¢˜ 1ï¼šæ ·æœ¬å°‘ï¼Œå®¹æ˜“è¯¯åˆ¤

ä¾‹å¦‚çœŸå®æ¦‚ç‡ï¼š

* Aï¼š0.6
* Bï¼š0.4

ä½ å„ç© 10 æ¬¡ï¼Œå¯èƒ½å‡ºç°ï¼š

* Aï¼šä¸­äº† 4 æ¬¡ï¼ˆ0.4ï¼‰
* Bï¼šä¸­äº† 7 æ¬¡ï¼ˆ0.7ï¼‰

éšæœºæ³¢åŠ¨å®Œå…¨æœ‰å¯èƒ½è®©ä½ â€œçœ‹åäº†â€ã€‚
ä¸€æ—¦çœ‹ååé¢å°±å…¨æŠ¼åœ¨é”™è¯¯çš„ B ä¸Š â†’ é•¿æœŸæŸå¤±å¤§ã€‚

---

### é—®é¢˜ 2ï¼šä¸€æ—¦è¯¯åˆ¤å°±å½»åº•é”æ­»ï¼ˆæ— æ³•çº æ­£ï¼‰

æœ´ç´ ç­–ç•¥â€œè¯•å®Œä¸€åœˆå°±ä¸å†æ¢ç´¢â€ï¼Œ
æ²¡æœ‰ç»™åç»­â€œçº é”™â€çš„æœºä¼šã€‚

æ•´ä¸ªç®—æ³•**ç¼ºå°‘æŒç»­æ¢ç´¢**ï¼Œä¸å¤Ÿç¨³å¥ã€‚

---

# 5. Îµ-greedyï¼šæœ€ç®€å•çš„æ”¹è¿›ç­–ç•¥

ä¸ºäº†é¿å…â€œçœ‹ä¸€æ¬¡å°±ä¿¡ä¸€è¾ˆå­â€ï¼Œæˆ‘ä»¬å¼•å…¥æœ€ç®€å•çš„æ”¹è¿›ï¼š

> **Îµ-greedy**ï¼š
>
> * å¤§éƒ¨åˆ†æ—¶é—´é€‰æ‹©å½“å‰ä¼°è®¡æœ€å¥½çš„æœºå­ï¼ˆåˆ©ç”¨ï¼‰
> * å°éƒ¨åˆ†æ—¶é—´éšæœºé€‰æ‹©ä»»æ„ä¸€å°æœºå­ï¼ˆæ¢ç´¢ï¼‰

---

å…·ä½“åšæ³•ï¼š

* ç»´æŠ¤æ¯ä¸ªè‡‚$a$çš„ï¼š

  * é€‰æ‹©æ¬¡æ•°$N_a$
  * å¹³å‡å¥–åŠ±ä¼°è®¡$\hat{Q}_a$
* æ¯è½®ï¼š

  1. ä»¥æ¦‚ç‡$\varepsilon$ï¼š**æ¢ç´¢**
     â†’ åœ¨æ‰€æœ‰è‡‚ä¸­éšæœºé€‰ä¸€ä¸ª
  2. ä»¥æ¦‚ç‡$1 - \varepsilon$ï¼š**åˆ©ç”¨**
     â†’ é€‰$\arg\max_a \hat{Q}_a$

$$
a_t =
\begin{cases}
\text{éšæœºé€‰ä¸€ä¸ªè‡‚} & \text{ä»¥æ¦‚ç‡ }\varepsilon \
\arg\max_a \hat{Q}_a & \text{ä»¥æ¦‚ç‡ }1-\varepsilon
\end{cases}
$$

---

å¹³å‡å¥–åŠ±ç”¨**æ ·æœ¬å¹³å‡å¢é‡æ›´æ–°**ï¼š

$$
\hat{Q}_a^{\text{new}} = \hat{Q}_a^{\text{old}} + \frac{1}{N_a^{\text{new}}}\left(R - \hat{Q}_a^{\text{old}}\right)
$$

ç›´è§‰ï¼š

* Îµ-greedy ä¼š **æŒç»­ç»™æ¯ä¸ªè‡‚ä¸€äº›æœºä¼š**ï¼Œå³ä½¿æ—©æœŸè¯¯åˆ¤ï¼Œä¹Ÿæœ‰å¯èƒ½æ…¢æ…¢çº æ­£ã€‚
*$\varepsilon$å¤§ â†’ æ¢ç´¢å¤šï¼›$\varepsilon$å° â†’ åˆ©ç”¨å¤šã€‚

---

# 6. Îµ-greedy çš„é—®é¢˜ï¼šéšæœºæ¢ç´¢ä¸å¤Ÿèªæ˜

Îµ-greedy å·²ç»æ¯”æœ´ç´ ç­–ç•¥å¼ºå¾ˆå¤šï¼Œä½†ä»ç„¶å¾ˆâ€œç¬¨â€ï¼š

### â‘  æ¢ç´¢ä¸åˆ†é’çº¢çš‚ç™½

* æœ‰çš„è‡‚å·²ç»è¢«è¯æ˜å¾ˆå·®ï¼ˆå¹³å‡å¥–åŠ±å¾ˆä½ã€è¯•éªŒæ¬¡æ•°å¤šï¼‰ï¼Œè¿˜ä¼šè¢«éšæœºæ¢ç´¢ã€‚
* æœ‰çš„è‡‚æ•°æ®å¾ˆå°‘ã€éå¸¸ä¸ç¡®å®šï¼Œå´æ²¡æœ‰å¾—åˆ°æ›´å¤šâ€œä¼˜å…ˆæ¢ç´¢â€ã€‚

â†’ å®ƒä¸ä¼šæ ¹æ®â€œè°æ›´ä¸ç¡®å®šâ€æ¥å®‰æ’æ¢ç´¢ï¼Œåªæ˜¯**çº¯éšæœº**ã€‚

---

### â‘¡ ä¸è€ƒè™‘â€œä¸ç¡®å®šåº¦â€

ä¾‹å¦‚ï¼š

* Aï¼šè¯•äº† 100 æ¬¡ï¼Œå¹³å‡ 0.6 â†’ ç›¸å¯¹ç¡®å®š
* Bï¼šè¯•äº† 3 æ¬¡ï¼Œå¹³å‡ 0.55 â†’ æä¸ç¡®å®š

æŒ‰ç†è¯´åº”è¯¥ä¼˜å…ˆæ¢ç´¢ Bï¼Œ
å› ä¸º B å¯èƒ½å…¶å®æ¯” A æ›´å¥½ï¼Œåªæ˜¯æ ·æœ¬å°‘ã€‚
ä½† Îµ-greedy æ¢ç´¢æ—¶å¯¹ Aã€B ä¸€è§†åŒä»ã€‚

---

### â‘¢ æ¢ç´¢æ¯”ä¾‹å›ºå®šï¼Œä¸éšæ—¶é—´å˜åŒ–

* æ—©æœŸæ•°æ®å°‘ï¼Œæœ¬è¯¥æ›´å¤šæ¢ç´¢ï¼›
* åæœŸå·²ç»æ¯”è¾ƒç¡®å®šï¼Œæœ¬è¯¥å‡å°‘æ¢ç´¢ã€‚

å›ºå®š Îµ ä¸ä¼šè‡ªåŠ¨è°ƒæ•´ã€‚

---

# 7. UCBï¼ˆä¸Šç½®ä¿¡ç•Œï¼‰ï¼šç”¨â€œä¸ç¡®å®šæ€§â€æŒ‡å¯¼æ¢ç´¢

UCB çš„æ ¸å¿ƒæ€æƒ³ï¼š

> å¯¹æ¯ä¸ªè‡‚ï¼Œä¸ä»…çœ‹å½“å‰å¹³å‡å¥–åŠ±ï¼Œè¿˜è¦åŠ ä¸Šä¸€ä¸ªâ€œ**ä¸ç¡®å®šæ€§è¡¥å¿é¡¹**â€ã€‚
> é€‰æ‹©â€œ**å¹³å‡å¥–åŠ± + ä¸ç¡®å®šæ€§**â€æœ€å¤§çš„é‚£ä¸ªè‡‚ã€‚

ç›´è§‰ï¼š

* ç©å¾—å°‘çš„è‡‚ â†’ ä¸ç¡®å®šæ€§å¤§ â†’ é¢å¤–åŠ åˆ†å¤š â†’ ä¼šæ›´å¤šè¢«æ¢ç´¢
* ç©å¾—å¤šçš„è‡‚ â†’ ä¸ç¡®å®šæ€§å° â†’ é¢å¤–åŠ åˆ†å°‘ â†’ åªåœ¨å®ƒçœŸçš„å¥½æ—¶è¢«é€‰

---

### UCB1 ç®—æ³•å…¬å¼

å¯¹æ¯ä¸ªè‡‚$a$ï¼Œåœ¨ç¬¬$t$æ­¥æ—¶è®¡ç®—ï¼š

$$
UCBaâ€‹(t)=Q^â€‹aâ€‹(t)+Naâ€‹(t)2lntâ€‹
$$

ç„¶åé€‰æ‹©ï¼š

$$
a_t = \arg\max_a \text{UCB}_a(t)
$$

è§£é‡Šï¼š

*$\hat{Q}_a(t)$ï¼šå½“å‰å¹³å‡å¥–åŠ±ï¼ˆåˆ©ç”¨ï¼‰
*$\sqrt{\frac{2 \ln t}{N_a(t)}}$ï¼šä¸ç¡®å®šæ€§é¡¹ï¼ˆæ¢ç´¢ï¼‰

  *$N_a(t)$å¤§ â†’ æ¢å¾—å¤š â†’ ä¸ç¡®å®šæ€§å°
  *$t$å¢å¤§ â†’$\ln t$å¢å¤§å¾ˆæ…¢ â†’ è¡¨ç¤ºâ€œéšç€æ—¶é—´æ¨ç§»ï¼Œæ¢ç´¢åŠ›åº¦ç¼“æ…¢å‡å¼±ä½†ä¸ä¼šæ¶ˆå¤±â€

---

### ä¸ç¡®å®šæ€§é¡¹ä¸ºä»€ä¹ˆå¤§è‡´æ˜¯$\sqrt{1/N}$ï¼Ÿ

* æ¦‚ç‡è®ºé‡Œï¼Œ**æ ·æœ¬å¹³å‡å€¼çš„æ ‡å‡†å·® ~$1/\sqrt{N}$**ã€‚
* è¯•å¾—è¶Šå¤šï¼Œå¹³å‡ä¼°è®¡è¶Šå‡†ï¼Œç½®ä¿¡åŒºé—´è¶Šçª„ã€‚
* UCB ç”¨$\sqrt{\frac{\ln t}{N_a}}$æ¥è¿‘ä¼¼â€œä¸ç¡®å®šæ€§â€çš„å¤§å°ã€‚

ç»“è®ºï¼š

> UCB ä¼šä¼˜å…ˆæ¢ç´¢é‚£äº›
> â€œç›®å‰çœ‹è¿˜è¡Œ + è¯•å¾—ä¸å¤š â†’ ä¸ç¡®å®šæ€§é«˜ã€æ½œåœ¨å¯èƒ½æ›´å¥½â€çš„è‡‚ã€‚

æ¢ç´¢æ˜¯**æœ‰ä¼˜å…ˆçº§ã€æœ‰ç›®çš„çš„**ï¼Œä¸å†ç›²ç›®ã€‚

---

# 8. Thompson Samplingï¼šç”¨æ¦‚ç‡åšå†³ç­–çš„ä¼˜é›…æ–¹æ³•

Thompson Sampling æ›´åƒäººç±»æ€è€ƒï¼š

> ä¸ç›´æ¥æ¯”è¾ƒâ€œå½“å‰å¹³å‡å€¼è°æœ€å¤§â€ï¼Œ
> è€Œæ˜¯ç»™æ¯ä¸ªè‡‚ä¸€ä¸ªâ€œ**å¯èƒ½çœŸå®æ¦‚ç‡çš„åˆ†å¸ƒ**â€ï¼Œ
> ç„¶åä»è¿™ä¸ªåˆ†å¸ƒä¸­**é‡‡æ ·**ï¼Œçœ‹çœ‹â€œè°æ›´å¯èƒ½æ˜¯å† å†›â€ã€‚

åœ¨ 0/1 å¥–åŠ±çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ç”¨ï¼š

* å¥–åŠ±æ¨¡å‹ï¼š$R \sim \text{Bernoulli}(p_a)$
* å¯¹$p_a$çš„ä¿¡å¿µï¼š$p_a \sim \text{Beta}(\alpha_a, \beta_a)$

![bg right:40% 100%](https://s.ar8.top/img/picgo/20251210193459345.webp)

---

### 1. åˆå§‹åŒ–å…ˆéªŒ

æ¯ä¸ªè‡‚ä¸€å¼€å§‹éƒ½å‡è®¾ï¼š

$$
p_a \sim \text{Beta}(1,1)
$$

Beta(1,1$æ˜¯å‡åŒ€åˆ†å¸ƒ â†’ è¡¨ç¤ºâ€œ0~1 éƒ½æœ‰å¯èƒ½â€ã€‚

---

### 2. æ•°æ®æ›´æ–°è§„åˆ™ï¼ˆåéªŒï¼‰

å¦‚æœæŸè‡‚$a$æ€»å…±è¯•äº†$N_a$æ¬¡ï¼š

* æˆåŠŸï¼ˆå¥–åŠ±=1ï¼‰æ¬¡æ•°$S_a$
* å¤±è´¥ï¼ˆå¥–åŠ±=0ï¼‰æ¬¡æ•°$F_a = N_a - S_a$

åˆ™ï¼š

$$
p_a \mid \text{æ•°æ®} \sim \text{Beta}(\alpha_a, \beta_a)
$$
å…¶ä¸­ï¼š

$$
\alpha_a = 1 + S_a,\quad \beta_a = 1 + F_a
$$

**æ¯æ¬¡æˆåŠŸ â†’ Î± åŠ  1ï¼›
æ¯æ¬¡å¤±è´¥ â†’ Î² åŠ  1ã€‚**

---

### 3. å†³ç­–æ­¥éª¤ï¼ˆæ¯ä¸€è½®ï¼‰

åœ¨ç¬¬$t$æ­¥ï¼š

1. å¯¹æ¯ä¸ªè‡‚$a$ï¼š
$$
   \tilde{p}_a^{(t)} \sim \text{Beta}(\alpha_a^{(t)}, \beta_a^{(t)})
$$
2. é€‰æ‹©é‡‡æ ·å€¼æœ€å¤§çš„è‡‚ï¼š
$$
   a_t = \arg\max_a \tilde{p}_a^{(t)}
$$
3. æ‹‰è¿™ä¸ªè‡‚ï¼Œå¾—åˆ°å¥–åŠ±$R_t \in {0,1})
4. æ›´æ–°ï¼š

   * è‹¥$R_t=1$ï¼š$\alpha_{a_t} \leftarrow \alpha_{a_t} + 1$
   * è‹¥$R_t=0$ï¼š$\beta_{a_t} \leftarrow \beta_{a_t} + 1$

---

ç‰¹ç‚¹ï¼š

* ä¸ç¡®å®šæ€§é«˜çš„è‡‚ â†’ Beta åˆ†å¸ƒæ›´â€œå®½â€ï¼Œæ›´å®¹æ˜“å¶å°”æŠ½åˆ°å¾ˆé«˜çš„å€¼ â†’ å¾—åˆ°æ›´å¤šæ¢ç´¢æœºä¼šã€‚
* æ•°æ®å¤šäº†ä¹‹åï¼š

  * åˆ†å¸ƒå˜çª„ â†’ ä¸ç¡®å®šæ€§è‡ªåŠ¨é™ä½ â†’ æ¢ç´¢è‡ªç„¶å‡å°‘ã€‚
* å®Œå…¨ä¸éœ€è¦æ‰‹åŠ¨è®¾ç½® Îµã€æˆ–è®¾è®¡ä¸ç¡®å®šæ€§å…¬å¼ï¼Œä¸€åˆ‡ç”±æ¦‚ç‡åˆ†å¸ƒâ€œè‡ªé€‚åº”â€ã€‚

