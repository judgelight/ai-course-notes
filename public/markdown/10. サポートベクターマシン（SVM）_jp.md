---
marp: true
theme: default
paginate: true
math: katex
---

<style>
section {
  font-family: "Microsoft YaHei", "PingFang SC", "Source Han Sans", "Noto Sans CJK SC", sans-serif;
}
</style>

## <!-- fit -->ğŸ“˜ ç¬¬10è¬›ï¼šã‚µãƒãƒ¼ãƒˆãƒ™ã‚¯ã‚¿ãƒ¼ãƒã‚·ãƒ³ï¼ˆSVMï¼‰

---

### ç¬¬1ç¯€ï¼šSVM ã®èƒŒæ™¯ã¨ç·šå½¢åˆ†é›¢å¯èƒ½ãªåˆ†é¡

#### 1.1 åˆ†é¡å•é¡Œã®æŒ¯ã‚Šè¿”ã‚Š

* **äºŒå€¤åˆ†é¡ã‚¿ã‚¹ã‚¯**ï¼šç‰¹å¾´ãƒ™ã‚¯ãƒˆãƒ« $\mathbf{x}\in\mathbb R^d$ ãŒä¸ãˆã‚‰ã‚Œï¼Œãƒ©ãƒ™ãƒ« $y\in\{-1,+1\}$ ã‚’äºˆæ¸¬ã™ã‚‹ã€‚  
* ã‚ˆãä½¿ã‚ã‚Œã‚‹æ‰‹æ³•ï¼šãƒ‘ãƒ¼ã‚»ãƒ—ãƒˆãƒ­ãƒ³ï¼ˆPerceptronï¼‰ï¼Œãƒ­ã‚¸ã‚¹ãƒ†ã‚£ãƒƒã‚¯å›å¸°ï¼ˆLogistic Regressionï¼‰  
  * ãƒ‘ãƒ¼ã‚»ãƒ—ãƒˆãƒ­ãƒ³ã¯åˆ†é¡ã®æ­£èª¤ã®ã¿ã‚’ä¿è¨¼ã—ï¼Œæ±ºå®šå¢ƒç•ŒãŒä¸å®‰å®šã«ãªã‚Šã‚„ã™ã„ã€‚  
  * ãƒ­ã‚¸ã‚¹ãƒ†ã‚£ãƒƒã‚¯å›å¸°ã¯ç¢ºç‡ã®å¯¾æ•°æå¤±ï¼ˆlog-lossï¼‰ã‚’æœ€é©åŒ–ã™ã‚‹ã€‚  

---

#### 1.2 æœ€å¤§ãƒãƒ¼ã‚¸ãƒ³è¶…å¹³é¢

* **å•é¡Œè¨­å®š**ï¼šæ­£ã—ãåˆ†é¡ã™ã‚‹ç·šå½¢è¶…å¹³é¢ã®ä¸­ã§ï¼Œæœ€ã‚‚â€œé ‘å¥â€ãªã‚‚ã®ã¯ã©ã‚Œã‹ï¼Ÿ  
* **è§£ç­”**ï¼šâ€œå¹¾ä½•ãƒãƒ¼ã‚¸ãƒ³â€ï¼ˆgeometric marginï¼‰ã‚’æœ€å¤§åŒ–ã™ã‚‹è¶…å¹³é¢ã‚’é¸ã¶ã€‚  

  * è¶…å¹³é¢ã‚’ $\mathbf w^\top \mathbf x + b = 0$ ã¨ã™ã‚‹ã¨ï¼Œã‚µãƒ³ãƒ—ãƒ« $(\mathbf x_i,y_i)$ ã«å¯¾ã™ã‚‹é–¢æ•°ãƒãƒ¼ã‚¸ãƒ³ã¯  
    $$y_i(\mathbf w^\top \mathbf x_i + b).$$  
  * å¹¾ä½•ãƒãƒ¼ã‚¸ãƒ³ã¯  
    $$
      \hat\gamma_i = \frac{y_i(\mathbf w^\top \mathbf x_i + b)}{\|\mathbf w\|}.
    $$  
  * æœ€å°ã®å¹¾ä½•ãƒãƒ¼ã‚¸ãƒ³ã‚’æœ€å¤§åŒ–ã™ã‚‹ã“ã¨ã§ï¼Œãƒ¢ãƒ‡ãƒ«ã®ãƒã‚¤ã‚ºè€æ€§ã‚’é«˜ã‚ã‚‹ã€‚  

---

#### 1.3 ã‚µãƒãƒ¼ãƒˆãƒ™ã‚¯ã‚¿ãƒ¼

è¶…å¹³é¢ã‹ã‚‰æœ€ã‚‚è¿‘ã„ã‚µãƒ³ãƒ—ãƒ«ç‚¹ã‚’ **ã‚µãƒãƒ¼ãƒˆãƒ™ã‚¯ã‚¿ãƒ¼** ã¨å‘¼ã¶ã€‚

![bg right:50%](https://s.ar8.top/img/picgo/20250709181950978.webp)

---

#### 1.4 æœ€é©ãƒãƒ¼ã‚¸ãƒ³åˆ†é¡å™¨ï¼ˆãƒãƒ¼ãƒ‰ãƒãƒ¼ã‚¸ãƒ³ SVMï¼‰

* **æœ€é©åŒ–å•é¡Œ**ï¼š  
  $$
  \begin{aligned}
    &\max_{\mathbf w, b}\;\min_i\;\hat\gamma_i
    \quad\Longleftrightarrow\quad
    \min_{\mathbf w,b}\;\frac{1}{2}\|\mathbf w\|^2,\\
    &\text{s.t.}\quad y_i(\mathbf w^\top \mathbf x_i + b)\ge1,\;\forall i.
  \end{aligned}
  $$  
* å¹¾ä½•çš„ã«ã¯ï¼Œå…¨ã‚µãƒ³ãƒ—ãƒ«ãŒè¶…å¹³é¢ã‹ã‚‰å°‘ãªãã¨ã‚‚è·é›¢ $1/\|\mathbf w\|$ ã‚’ä¿ã¤ã‚ˆã†ã«ã™ã‚‹ã€‚  

![bg right:50%](https://s.ar8.top/img/picgo/20250709181950978.webp)

---

#### 1.5 â€œãƒãƒ¼ãƒ‰ãƒãƒ¼ã‚¸ãƒ³ SVMâ€ æœ€é©åŒ–ç›®æ¨™ã®è©³ç´°

##### 1.5.1 ã€Œå¹¾ä½•ãƒãƒ¼ã‚¸ãƒ³æœ€å¤§åŒ–ã€ã‹ã‚‰ã€Œé‡ã¿ãƒãƒ«ãƒ æœ€å°åŒ–ã€ã¸

###### 1.5.1.1 å¹¾ä½•ãƒãƒ¼ã‚¸ãƒ³ã®å®šç¾©

* è¶…å¹³é¢ $\mathbf w^\top \mathbf x + b = 0$ ã«å¯¾ã—ï¼Œç‚¹ $\mathbf x_i$ ã‹ã‚‰ã®è·é›¢ã¯  
  $$
    d_i = \frac{\bigl|\mathbf w^\top \mathbf x_i + b\bigr|}{\|\mathbf w\|}.
  $$  
* ãƒ©ãƒ™ãƒ«ä»˜ãã‚µãƒ³ãƒ—ãƒ« $y_i\in\{+1,-1\}$ ã®å ´åˆï¼Œç¬¦å·ä»˜ãå¹¾ä½•ãƒãƒ¼ã‚¸ãƒ³ã¯  
  $$
    \hat\gamma_i 
    = y_i\;\frac{\mathbf w^\top \mathbf x_i + b}{\|\mathbf w\|}.
  $$  

---

###### 1.5.1.2 æœ€å°ãƒãƒ¼ã‚¸ãƒ³ã®æœ€å¤§åŒ–

* ã€Œå…¨ã‚µãƒ³ãƒ—ãƒ«ã®å¹¾ä½•ãƒãƒ¼ã‚¸ãƒ³ã®æœ€å°å€¤ã‚’æœ€å¤§åŒ–ã™ã‚‹ã€ã“ã¨ã‚’ç›®æŒ‡ã™ï¼š  
  $$
    \max_{\mathbf w,b}\;\min_{i}\;\hat\gamma_i.
  $$  
* ã“ã‚Œã«ã‚ˆã‚Šï¼Œæœ€ã‚‚å¢ƒç•Œã«è¿‘ã„ç‚¹ãŒã§ãã‚‹ã ã‘é›¢ã‚Œã‚‹ã‚ˆã†ã«ãªã‚‹ã€‚  

---

###### 1.5.1.3 ãƒãƒ¼ã‚¸ãƒ³ã®æ­£è¦åŒ–

* $(\mathbf w,b)$ ã‚’ä»»æ„ã®ã‚¹ã‚«ãƒ©ãƒ¼ $\kappa>0$ ã§ã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°ã§ãã‚‹è‡ªç”±åº¦ã‚’é™¤å»ã™ã‚‹ãŸã‚ï¼Œ  
  $$
    \min_i\,y_i(\mathbf w^\top \mathbf x_i + b) = 1
  $$  
  ã¨è¦å®šã™ã‚‹ã€‚  
* ã“ã®ä¸‹ã§ï¼Œåˆ¶ç´„ã¯  
  $$
    y_i(\mathbf w^\top \mathbf x_i + b)\ge1,\quad \forall i
  $$  
  ã¨ãªã‚Šï¼Œå¹¾ä½•ãƒãƒ¼ã‚¸ãƒ³ã®æœ€å°å€¤ã¯ $1/\|\mathbf w\|$ ã«ãªã‚‹ã€‚  
* ã‚ˆã£ã¦ï¼Œ$\min_i\hat\gamma_i$ ã®æœ€å¤§åŒ–ã¯ $\|\mathbf w\|^{-1}$ ã®æœ€å¤§åŒ–ï¼Œã™ãªã‚ã¡ $\|\mathbf w\|$ ã®æœ€å°åŒ–ã«ç­‰ã—ã„ã€‚  

---

##### 1.5.2 æœ€çµ‚çš„ãªãƒ—ãƒ©ã‚¤ãƒãƒ«å½¢å¼

* è¨ˆç®—ã‚’ç°¡æ½”ã«ã™ã‚‹ãŸã‚ï¼Œç›®çš„é–¢æ•°ã‚’ $\tfrac12\|\mathbf w\|^2$ ã¨æ›¸ãç›´ã™ï¼š  
  $$
  \begin{aligned}
    &\min_{\mathbf w,b}
    \quad \frac{1}{2}\|\mathbf w\|^2,\\[6pt]
    &\text{s.t.}\quad
    y_i(\mathbf w^\top \mathbf x_i + b)\ge1,\;i=1,\dots,N.
  \end{aligned}
  $$  
* **ç›®çš„**ï¼š$\|\mathbf w\|$ ã‚’å°ã•ãã—ã¦ãƒãƒ¼ã‚¸ãƒ³ã‚’åºƒã’ã‚‹ã€‚  
* **åˆ¶ç´„**ï¼šå…¨ã‚µãƒ³ãƒ—ãƒ«ã‚’æ­£ã—ãåˆ†é¡ã—ï¼Œé–¢æ•°ãƒãƒ¼ã‚¸ãƒ³ãŒ 1 ä»¥ä¸Šã§ã‚ã‚‹ã“ã¨ã‚’ä¿è¨¼ã€‚  

![bg right:50%](https://s.ar8.top/img/picgo/20250709181950978.webp)

---

##### 1.5.3 å¹¾ä½•çš„è§£é‡ˆ

> **è¦ç‚¹**ï¼šæ­£è¦åŒ–å¾Œï¼Œæ­£è² ä¸¡ã‚¯ãƒ©ã‚¹ã®æœ€ã‚‚è¿‘ã„ã‚µãƒ³ãƒ—ãƒ«ã¯ï¼Œå¹… $2/\|\mathbf w\|$ ã®ãƒãƒ¼ã‚¸ãƒ³ä¸Šã«ã‚ã‚‹ã€‚

1. **æ±ºå®šé¢**ï¼š$\mathbf w^\top \mathbf x + b = 0$  
2. **æ­£ã‚¯ãƒ©ã‚¹å¢ƒç•Œ**ï¼š$\mathbf w^\top \mathbf x + b = +1$  
3. **è² ã‚¯ãƒ©ã‚¹å¢ƒç•Œ**ï¼š$\mathbf w^\top \mathbf x + b = -1$  

* ã“ã‚Œã‚‰ã¯ã™ã¹ã¦å¹³è¡Œã§ï¼Œè·é›¢ã¯  
  $$
    \frac{+1 - (-1)}{\|\mathbf w\|}
    = \frac{2}{\|\mathbf w\|}.
  $$  
* ãƒãƒ¼ã‚¸ãƒ³å¹…ã¯ã“ã®è·é›¢ï¼ŒåŠå¹…ã¯ $1/\|\mathbf w\|$ã€‚  

---

### ç¬¬2ç¯€ï¼šãƒ—ãƒ©ã‚¤ãƒãƒ«å•é¡Œã¨ãƒ©ã‚°ãƒ©ãƒ³ã‚¸ãƒ¥åŒå¯¾

#### 2.1 ãƒ—ãƒ©ã‚¤ãƒãƒ«å½¢å¼

$$
\min_{\mathbf w,b}\;\frac{1}{2}\|\mathbf w\|^2
\quad
\text{s.t.}\;y_i(\mathbf w^\top \mathbf x_i + b)\ge1,\;i=1,\dots,N.
$$

#### 2.2 ãƒ©ã‚°ãƒ©ãƒ³ã‚¸ãƒ¥é–¢æ•°ã®æ§‹ç¯‰

* ãƒ©ã‚°ãƒ©ãƒ³ã‚¸ãƒ¥ä¹—æ•° $\alpha_i\ge0$ ã‚’å°å…¥ã—ã¦ï¼Œ  
  $$
  L(\mathbf w,b,\boldsymbol\alpha)
  = \frac{1}{2}\|\mathbf w\|^2 - \sum_{i=1}^N \alpha_i\bigl[y_i(\mathbf w^\top \mathbf x_i + b)-1\bigr].
  $$  

---

#### 2.3 KKT æ¡ä»¶ã¨åŒå¯¾å•é¡Œ

* $\mathbf w,b$ ã§åå¾®åˆ†ã—ã¦ã‚¼ãƒ­ã«ã™ã‚‹ã¨ï¼š  
  $$
  \frac{\partial L}{\partial \mathbf w}
  = \mathbf w - \sum_i \alpha_i y_i\mathbf x_i = 0
  \;\Longrightarrow\;
  \mathbf w = \sum_i\alpha_i y_i\mathbf x_i;
  $$  
  $$
  \frac{\partial L}{\partial b}
  = -\sum_i \alpha_i y_i = 0.
  $$  

---

* ã“ã‚Œã‚’ä»£å…¥ã—ã¦å¾—ã‚‰ã‚Œã‚‹åŒå¯¾å•é¡Œï¼š  
  $$
  \begin{aligned}
    &\max_{\boldsymbol\alpha}\;\sum_{i=1}^N \alpha_i - \frac12\sum_{i,j}\alpha_i\alpha_j y_i y_j \mathbf x_i^\top \mathbf x_j,\\
    &\text{s.t.}\;\sum_i\alpha_i y_i=0,\;\alpha_i\ge0.
  \end{aligned}
  $$  
* **ã‚µãƒãƒ¼ãƒˆãƒ™ã‚¯ã‚¿ãƒ¼**ï¼š$\alpha_i>0$ ã‚’æŒã¤ã‚µãƒ³ãƒ—ãƒ«ã¯ãƒãƒ¼ã‚¸ãƒ³å¢ƒç•Œä¸Šã«ã‚ã‚‹ã€‚  

---

#### 2.4 åŒå¯¾ã‹ã‚‰ãƒ¢ãƒ‡ãƒ«å¾©å…ƒ

* é‡ã¿ã¯  
  $$
    \mathbf w = \sum_{i=1}^N \alpha_i\,y_i\,\mathbf x_i.
  $$  
* ãƒã‚¤ã‚¢ã‚¹ $b$ ã¯ï¼Œä»»æ„ã®ã‚µãƒãƒ¼ãƒˆãƒ™ã‚¯ã‚¿ãƒ¼ $\mathbf x_k$ ã‚’ç”¨ã„ã¦ï¼š  
  $$
  b = y_k - \sum_i\alpha_i y_i \mathbf x_i^\top \mathbf x_k.
  $$  

---

### ç¬¬3ç¯€ï¼šã‚«ãƒ¼ãƒãƒ«ãƒˆãƒªãƒƒã‚¯ã¨éç·šå½¢åˆ†é¡

#### 3.1 éç·šå½¢åˆ†é›¢ã¨ç‰¹å¾´å†™åƒ

* ç·šå½¢åˆ†é›¢ä¸å¯èƒ½ãªãƒ‡ãƒ¼ã‚¿ã«ã¯ï¼Œå†™åƒ $\phi:\mathbb R^d\to\mathcal H$ï¼ˆé«˜æ¬¡å…ƒç‰¹å¾´ç©ºé–“ï¼‰ã‚’å°å…¥ã—ï¼Œãã®ç©ºé–“ã§ç·šå½¢åˆ†é¡ã‚’è¡Œã†ã€‚  

#### 3.2 ã‚«ãƒ¼ãƒãƒ«é–¢æ•°ã®å®šç¾©

* **ã‚«ãƒ¼ãƒãƒ«é–¢æ•°** $K(\mathbf x_i,\mathbf x_j)=\langle\phi(\mathbf x_i),\phi(\mathbf x_j)\rangle$  
* æ˜ç¤ºçš„ã« $\phi$ ã‚’è¨ˆç®—ã›ãšã«é¡ä¼¼åº¦ã‚’å¾—ã‚‰ã‚Œã‚‹ãƒ¡ãƒªãƒƒãƒˆã€‚  

---

#### 3.3 ä»£è¡¨çš„ãªã‚«ãƒ¼ãƒãƒ«

| ã‚«ãƒ¼ãƒãƒ«          | å…¬å¼                                                  | èª¬æ˜                         |
| ------------- | --------------------------------------------------- | -------------------------- |
| ç·šå½¢æ ¸ï¼ˆLinearï¼‰  | $K(\mathbf x,\mathbf z)=\mathbf x^\top\mathbf z$    | å†™åƒã›ãšï¼Œç·šå½¢ SVM ã«ç›¸å½“        |
| å¤šé …å¼æ ¸ï¼ˆPolyï¼‰  | $(\mathbf x^\top\mathbf z + r)^d$                   | ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ï¼šæ¬¡æ•° $d$, å®šæ•° $r$ |
| RBFï¼ˆã‚¬ã‚¦ã‚¹ï¼‰æ ¸  | $\exp\bigl(-\gamma\|\mathbf x-\mathbf z\|^2\bigr)$  | ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ï¼š$\gamma>0$        |
| ã‚·ã‚°ãƒ¢ã‚¤ãƒ‰æ ¸ï¼ˆSigmoidï¼‰ | $\tanh(\kappa\,\mathbf x^\top\mathbf z + \theta)$ | ãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ãƒãƒƒãƒˆé¢¨æ´»æ€§åŒ–é–¢æ•°    |

---

### ç¬¬4ç¯€ï¼šã‚½ãƒ•ãƒˆãƒãƒ¼ã‚¸ãƒ³ SVMï¼ˆè¨±å®¹åˆ†é¡ï¼‰

#### 4.1 ç·©å’Œå¤‰æ•°ã®å°å…¥

* å„ã‚µãƒ³ãƒ—ãƒ«ã«å¯¾ã— $\xi_i\ge0$ ã‚’å°å…¥ã—ï¼Œé•åã‚’è¨±å®¹ã™ã‚‹ã€‚  
* åˆ¶ç´„ã¯  
  $$
  y_i(\mathbf w^\top \mathbf x_i + b)\ge1-\xi_i.
  $$  

#### 4.2 æœ€é©åŒ–å•é¡Œ

$$
\min_{\mathbf w,b,\boldsymbol\xi}
\;\frac12\|\mathbf w\|^2 + C\sum_{i=1}^N \xi_i
\quad
\text{s.t.}\;
y_i(\mathbf w^\top \mathbf x_i + b)\ge1-\xi_i,\;\xi_i\ge0.
$$

* **ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ $C$**ï¼šãƒãƒ¼ã‚¸ãƒ³å¹…ã¨é•åãƒšãƒŠãƒ«ãƒ†ã‚£ã®ãƒˆãƒ¬ãƒ¼ãƒ‰ã‚ªãƒ•ã€‚  
  * $C$ ãŒå¤§ãã„ã»ã©ãƒãƒ¼ãƒ‰ãƒãƒ¼ã‚¸ãƒ³ã«è¿‘ã¥ãï¼Œ  
  * å°ã•ã„ã»ã©èª¤åˆ†é¡ã‚’è¨±å®¹ã—ã‚„ã™ããªã‚‹ã€‚  

---

#### 4.3 åŒå¯¾å½¢å¼ã¨ã‚«ãƒ¼ãƒãƒ«åŒ–

* ãƒãƒ¼ãƒ‰ãƒãƒ¼ã‚¸ãƒ³ã¨ã®å·®ã¯åˆ¶ç´„ã«ä¸Šç•Œ $\alpha_i\le C$ ãŒåŠ ã‚ã‚‹ç‚¹ã®ã¿ã€‚  

$$
\boxed{
\begin{aligned}
&\max_{\boldsymbol\alpha}
\quad
\sum_{i=1}^N \alpha_i
- \tfrac12 \sum_{i,j} \alpha_i\alpha_j\,y_i y_j\,(x_i^\top x_j),\\
&\text{s.t.}\quad
\sum_i \alpha_i y_i = 0,
\quad
0 \le \alpha_i \le C,\quad i=1,\dots,N.
\end{aligned}
}
$$

---

### ç¬¬5ç¯€ï¼šå¤šã‚¯ãƒ©ã‚¹ SVM ã¨å®Ÿè·µ
#### 5.1 å¤šã‚¯ãƒ©ã‚¹æˆ¦ç•¥
ä¸€å¯¾ä»–ï¼ˆOne-vs-Restï¼‰ï¼šå„ã‚¯ãƒ©ã‚¹ã«å¯¾ã—ã¦äºŒå€¤ SVM ã‚’è¨“ç·´

ä¸€å¯¾ä¸€ï¼ˆOne-vs-Oneï¼‰ï¼šã‚¯ãƒ©ã‚¹å¯¾ã”ã¨ã« SVM ã‚’è¨“ç·´ã—ï¼Œåˆè¨ˆ $K(K-1)/2$ å€‹ã‚’æ§‹ç¯‰

scikit-learn ã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã¯ One-vs-Rest ã‚’æ¡ç”¨ã€‚

#### 5.2 scikit-learn å®Ÿè£…ä¾‹

```python
from sklearn import datasets
from sklearn.model_selection import train_test_split, GridSearchCV
from sklearn.svm import SVC
from sklearn.metrics import classification_report, ConfusionMatrixDisplay

# ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿
X, y = datasets.load_iris(return_X_y=True)
X_train, X_test, y_train, y_test = train_test_split(
    X, y, test_size=0.3, random_state=42
)

# ãƒã‚¤ãƒ‘ãƒ¼ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿æ¢ç´¢
param_grid = [
    {'kernel': ['linear'], 'C': [0.1, 1, 10]},
    {'kernel': ['rbf'], 'C': [0.1, 1, 10], 'gamma': [0.1, 1, 10]},
]
grid = GridSearchCV(SVC(), param_grid, cv=5)
grid.fit(X_train, y_train)
print("Best params:", grid.best_params_)

# è©•ä¾¡
y_pred = grid.predict(X_test)
print(classification_report(y_test, y_pred))
ConfusionMatrixDisplay.from_estimator(grid, X_test, y_test)
```