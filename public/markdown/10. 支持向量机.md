---
marp: true
theme: default
paginate: true
math: katex
---

<style>
section {
  font-family: "Microsoft YaHei", "PingFang SC", "Source Han Sans", "Noto Sans CJK SC", sans-serif;
}
</style>

## <!-- fit -->ğŸ“˜ ç¬¬10è®²ï¼šæ”¯æŒå‘é‡æœºSVM

---

### ç¬¬1èŠ‚ï¼šSVM èƒŒæ™¯ä¸çº¿æ€§å¯åˆ†åˆ†ç±»

#### 1.1 åˆ†ç±»é—®é¢˜å›é¡¾

* **äºŒåˆ†ç±»ä»»åŠ¡**ï¼šç»™å®šç‰¹å¾å‘é‡ $\mathbf{x}\in\mathbb R^d$ï¼Œæ ‡ç­¾ $y\in\{-1,+1\}$ã€‚
* å¸¸è§æ–¹æ³•ï¼šæ„ŸçŸ¥æœºï¼ˆPerceptronï¼‰ã€é€»è¾‘å›å½’ï¼ˆLogistic Regressionï¼‰â€”â€”æ„ŸçŸ¥æœºåªä¿è¯åˆ†ç±»æ­£ç¡®ï¼Œä½†å¯¹è¾¹ç•Œä¸ç¨³å®šï¼›é€»è¾‘å›å½’ä¼˜åŒ–æ¦‚ç‡å¯¹æ•°æŸå¤±ã€‚

---

#### 1.2 æœ€å¤§é—´éš”çš„è¶…å¹³é¢

* **é—®é¢˜**ï¼šåœ¨æ‰€æœ‰æ­£ç¡®åˆ†ç±»çš„çº¿æ€§è¶…å¹³é¢ä¸­ï¼Œé€‰æ‹©å“ªä¸ªæœ€â€œç¨³å¥â€ï¼Ÿ
* **ç­”æ¡ˆ**ï¼šæœ€å¤§åŒ–â€œå‡ ä½•é—´éš”â€ï¼ˆgeometric marginï¼‰ã€‚

  * ç»™å®šè¶…å¹³é¢ $\mathbf w^\top \mathbf x + b = 0$ï¼Œå¯¹ç‚¹ $(\mathbf x_i,y_i)$ï¼Œå…¶å‡½æ•°é—´éš” $y_i(\mathbf w^\top \mathbf x_i + b)$ã€‚
  * å‡ ä½•é—´éš”å®šä¹‰ä¸ºï¼š

    $$
      \hat\gamma_i = \frac{y_i(\mathbf w^\top \mathbf x_i + b)}{\|\mathbf w\|}.
    $$
  * æœ€å¤§åŒ–æœ€å°å‡ ä½•é—´éš”ï¼Œæå‡æ¨¡å‹å¯¹å™ªå£°çš„é²æ£’æ€§ã€‚

---

#### 1.3 æ”¯æŒå‘é‡
æ ·æœ¬ä¸­è·ç¦»è¶…å¹³é¢æœ€è¿‘çš„ä¸€äº›ç‚¹ï¼Œè¿™äº›ç‚¹å«åšæ”¯æŒå‘é‡

![bg right:50%](https://s.ar8.top/img/picgo/20250709181950978.webp)

---

#### 1.4 æœ€ä¼˜é—´éš”åˆ†ç±»å™¨ï¼ˆç¡¬é—´éš” SVMï¼‰

* **ä¼˜åŒ–ç›®æ ‡**ï¼š

  $$
  \begin{aligned}
    &\max_{\mathbf w, b}\;\min_i\;\hat\gamma_i
    \quad\Longleftrightarrow\quad
    \min_{\mathbf w,b}\;\frac{1}{2}\|\mathbf w\|^2
  \\
    &\text{s.t.}\quad y_i(\mathbf w^\top \mathbf x_i + b)\ge1,\;\forall i.
  \end{aligned}
  $$
* å‡ ä½•è§£é‡Šï¼šå¸¦è·ç¦»æ ‡å°ºçš„å¹³é¢ï¼Œä¸¤ç±»æ ·æœ¬åˆ°è¶…å¹³é¢çš„è·ç¦»è‡³å°‘ä¸º 1/â€–wâ€–ã€‚
![bg right:50%](https://s.ar8.top/img/picgo/20250709181950978.webp)

---

#### 1.5 â€œç¡¬é—´éš” SVMâ€ä¼˜åŒ–ç›®æ ‡æ·±å…¥çš„æ‹†è§£ã€‚

##### 1.5.1. ä»â€œæœ€å¤§åŒ–å‡ ä½•é—´éš”â€åˆ°â€œæœ€å°åŒ–æƒé‡èŒƒæ•°â€

###### 1.5.1.1 å‡ ä½•é—´éš”ï¼ˆGeometric Marginï¼‰å®šä¹‰

* å¯¹äºè¶…å¹³é¢ $\mathbf w^\top \mathbf x + b = 0$ï¼Œä»»æ„ç‚¹ $\mathbf x_i$ åˆ°è¯¥è¶…å¹³é¢çš„è·ç¦»ä¸º

  $$
    d_i = \frac{\bigl|\mathbf w^\top \mathbf x_i + b\bigr|}{\|\mathbf w\|}.
  $$
* å¦‚æœæ ·æœ¬å¸¦æ ‡ç­¾ $y_i\in\{+1,-1\}$ï¼Œåˆ™æœ‰å¸¦ç¬¦å·çš„â€œå‡ ä½•é—´éš”â€

  $$
    \hat\gamma_i 
    = y_i\;\frac{\mathbf w^\top \mathbf x_i + b}{\|\mathbf w\|},
  $$

  è¿™æ ·æ­£ç±»ç‚¹ $(y_i=+1)$ å¾—åˆ°æ­£è·ç¦»ï¼Œè´Ÿç±»ç‚¹ $(y_i=-1)$ å¾—åˆ°è´Ÿè·ç¦»ã€‚

---

###### 1.5.1.2 æœ€å¤§åŒ–æœ€å°é—´éš”

* æˆ‘ä»¬å¸Œæœ›é€‰æ‹©ä¸€ä¸ªè¶…å¹³é¢ï¼Œä½¿å¾—â€œæ‰€æœ‰ç‚¹åˆ°è¶…å¹³é¢çš„æœ€å°å‡ ä½•é—´éš”â€æœ€å¤§ï¼Œå½¢å¼åŒ–ä¸º

  $$
    \max_{\mathbf w,b}\;\min_{i}\;\hat\gamma_i.
  $$
* è¿™ä¿è¯äº†æ— è®ºé¢å¯¹å“ªä¸ªæ ·æœ¬ï¼Œç¦»è¶…å¹³é¢æœ€è¿‘çš„é‚£ä¸ªç¦»å¾—å°½å¯èƒ½è¿œï¼Œä»è€Œè·å¾—æœ€å¥½çš„â€œé²æ£’æ€§â€ã€‚

---

###### 1.5.1.3 ç­‰ä»·åœ°ï¼Œå°†é—´éš”è§„èŒƒåŒ–åˆ° 1

ç”±äºå¯ä»¥åŒæ—¶æŠŠ $(\mathbf w, b)$ ç¼©æ”¾ä¸€ä¸ªæ­£æ•° $\kappa>0$ï¼ˆå³ä»¤ $\mathbf w'=\kappa\mathbf w,\;b'=\kappa b$ï¼‰ï¼Œè€Œå‡ ä½•é—´éš”ä¼šæŒ‰åŒæ ·æ¯”ä¾‹æ”¾å¤§ï¼Œç›´æ¥æœ€å¤§åŒ– $\min_i\hat\gamma_i$ å¹¶ä¸å”¯ä¸€ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªè‡ªç”±åº¦ï¼Œæˆ‘ä»¬**è§„å®š**ï¼š

$$
  \min_i\;y_i\bigl(\mathbf w^\top \mathbf x_i + b\bigr) = 1.
$$

åœ¨è¿™ä¸€â€œå½’ä¸€åŒ–â€ä¸‹ï¼Œæ‰€æœ‰æ ·æœ¬åˆ°æ— å½’ä¸€åŒ–è¶…å¹³é¢çš„å‡½æ•°é—´éš”éƒ½è‡³å°‘ä¸º 1ï¼Œå³

$$
  y_i\bigl(\mathbf w^\top \mathbf x_i + b\bigr)\;\ge\;1,\quad \forall i.
$$

æ­¤æ—¶ï¼Œå‡ ä½•é—´éš”ä¸­çš„åˆ†å­æœ€å°å€¼å›ºå®šä¸º 1ï¼Œäºæ˜¯

$$
  \min_i\,\hat\gamma_i
  = \frac{1}{\|\mathbf w\|}.
$$

å› æ­¤ï¼Œæœ€å¤§åŒ– $\min_i\hat\gamma_i$ å˜æˆäº†**æœ€å°åŒ–** $\|\mathbf w\|^{-1}$ï¼Œä¹Ÿå³**æœ€å°åŒ–** $\|\mathbf w\|$ã€‚

---

##### 1.5.2. æœ€ç»ˆçš„ä¼˜åŒ–é—®é¢˜ï¼ˆPrimal Formï¼‰

ä¸ºäº†ä¾¿äºè®¡ç®—ï¼Œåˆå¸¸å°†ç›®æ ‡å†™ä½œ $\tfrac12\|\mathbf w\|^2$ï¼ˆåŠ ä¸Š $\tfrac12$ åœ¨åç»­æ±‚å¯¼æ—¶æ›´ç®€æ´ï¼‰ï¼š

$$
\begin{aligned}
  &\min_{\mathbf w,b}
  \quad \frac{1}{2}\,\|\mathbf w\|^2
  \\[6pt]
  &\text{s.t.}\quad
  y_i\bigl(\mathbf w^\top \mathbf x_i + b\bigr)\;\ge\;1,
  \quad i=1,2,\dots,N.
\end{aligned}
$$

* **ç›®æ ‡**ï¼šè®© $\|\mathbf w\|$ å°½å¯èƒ½å° â‡’ é—´éš” $1/\|\mathbf w\|$ å°½å¯èƒ½å¤§ã€‚
* **çº¦æŸ**ï¼šä¿è¯æ‰€æœ‰æ ·æœ¬è¢«æ­£ç¡®åˆ†ç±»ï¼Œä¸”å‡½æ•°é—´éš” â‰¥ 1ã€‚
![bg right:50%](https://s.ar8.top/img/picgo/20250709181950978.webp)

---

##### 1.5.3. å‡ ä½•è§£é‡Šï¼ˆå¸¦è·ç¦»æ ‡å°ºçš„å¹³é¢ï¼‰

> **è¦ç‚¹**ï¼šåœ¨è¿™ä¸ªè§„èŒƒåŒ–ä¸‹ï¼Œç¦»è¶…å¹³é¢æœ€è¿‘çš„æ­£ã€è´Ÿç±»ç‚¹ï¼Œæ°å¥½è½åœ¨ä¸¤æ¡å¹³è¡Œä¸”è·ç¦»ä¸º $2/\|\mathbf w\|$ çš„è¾¹ç•Œçº¿ä¸Šã€‚

1. **å†³ç­–é¢**ï¼š$\mathbf w^\top\mathbf x + b = 0$ã€‚
2. **æ­£ç±»è¾¹ç•Œ**ï¼š$\mathbf w^\top\mathbf x + b = +1$ã€‚
3. **è´Ÿç±»è¾¹ç•Œ**ï¼š$\mathbf w^\top\mathbf x + b = -1$ã€‚

* è¿™ä¸¤æ¡ç•Œçº¿ä¸å†³ç­–é¢å¹³è¡Œï¼Œç›¸è·

  $$
    \frac{+1 - (-1)}{\|\mathbf w\|}
    = \frac{2}{\|\mathbf w\|}.
  $$
* å› æ­¤â€œé—´éš”å®½åº¦â€å®šä¹‰ä¸ºä¸¤æ¡è¾¹ç•Œé—´çš„è·ç¦»ï¼Œå³ $2/\|\mathbf w\|$ï¼Œè€Œä»å†³ç­–é¢åˆ°ä»»ä¸€è¾¹ç•Œçš„**åŠå®½åº¦**æ­£å¥½æ˜¯ $1/\|\mathbf w\|$ã€‚

---


### ç¬¬2èŠ‚ï¼šåŸå§‹é—®é¢˜ä¸æ‹‰æ ¼æœ—æ—¥å¯¹å¶

#### 2.1 åŸå§‹ï¼ˆPrimalï¼‰å½¢å¼

$$
\min_{\mathbf w,b}\;\frac{1}{2}\|\mathbf w\|^2
\quad
\text{s.t.}\;y_i(\mathbf w^\top \mathbf x_i + b)\ge1,\;i=1,\dots,N.
$$

#### 2.2 æ„é€ æ‹‰æ ¼æœ—æ—¥å‡½æ•°

å¼•å…¥æ‹‰æ ¼æœ—æ—¥ä¹˜å­ $\alpha_i \ge0$ï¼Œ

$$
L(\mathbf w,b,\boldsymbol\alpha)
= \frac{1}{2}\|\mathbf w\|^2 - \sum_{i=1}^N \alpha_i\bigl[y_i(\mathbf w^\top \mathbf x_i + b)-1\bigr].
$$

---
#### 2.3 KKT æ¡ä»¶ä¸å¯¹å¶é—®é¢˜

* å¯¹ $\mathbf w$ å’Œ $b$ æ±‚åå¯¼å¹¶ä»¤é›¶ï¼š

  $$
  \frac{\partial L}{\partial \mathbf w}
  = \mathbf w - \sum_i \alpha_i y_i\mathbf x_i = 0
  \quad\Longrightarrow\quad
  \mathbf w = \sum_i\alpha_i y_i\mathbf x_i;
  $$

  $$
  \frac{\partial L}{\partial b}
  = -\sum_i \alpha_i y_i = 0.
  $$

---

* ä»£å›å¾—åˆ°å¯¹å¶ï¼ˆDualï¼‰é—®é¢˜ï¼š

  $$
  \begin{aligned}
    &\max_{\boldsymbol\alpha}\;\sum_{i=1}^N \alpha_i - \frac12\sum_{i,j}\alpha_i\alpha_j y_i y_j \mathbf x_i^\top \mathbf x_j,\\
    &\text{s.t.}\;\sum_i\alpha_i y_i=0,\;\alpha_i\ge0.
  \end{aligned}
  $$
* **æ”¯æŒå‘é‡**ï¼šå¯¹åº” $\alpha_i>0$ çš„æ ·æœ¬ç‚¹ï¼Œä½äºé—´éš”è¾¹ç•Œæˆ–è¯¯åˆ†ç±»è¾¹ç•Œä¸Šã€‚

---

#### 2.4 ä»å¯¹å¶æ¢å¤æ¨¡å‹

* $\mathbf w$ å¦‚ä¸Šæ‰€ç¤º 
  $$
    w = \sum_{i=1}^N \alpha_i\,y_i\,\mathbf x_i
  $$
* æ±‚ $b$ æ—¶ï¼Œä»»é€‰ä¸€ä¸ªæ”¯æŒå‘é‡ $\mathbf x_k$ï¼š

  $$
  b = y_k - \sum_i\alpha_i y_i \mathbf x_i^\top \mathbf x_k.
  $$

---

### ç¬¬3èŠ‚ï¼šKernel Trick ä¸éçº¿æ€§åˆ†ç±»

#### 3.1 éçº¿æ€§å¯åˆ†ä¸ç‰¹å¾æ˜ å°„

* å½“æ•°æ®çº¿æ€§ä¸å¯åˆ†æ—¶ï¼Œå¼•å…¥æ˜ å°„ $\phi:\mathbb R^d\to\mathcal H$ï¼ˆé«˜ç»´ç‰¹å¾ç©ºé—´ï¼‰ï¼Œå†åœ¨ $\mathcal H$ ä¸­åšçº¿æ€§åˆ†ç±»ã€‚

#### 3.2 æ ¸å‡½æ•°å®šä¹‰

* **æ ¸å‡½æ•°** $K(\mathbf x_i,\mathbf x_j)=\langle\phi(\mathbf x_i),\phi(\mathbf x_j)\rangle$ã€‚
* ä¼˜åŠ¿ï¼šæ— éœ€æ˜¾å¼è®¡ç®— $\phi$ï¼Œåªéœ€æ ¸å‡½æ•°å€¼ã€‚

---

#### 3.3 å¸¸ç”¨æ ¸å‡½æ•°

| æ ¸ç±»å‹         | å…¬å¼                                                 | è¯´æ˜                  |
| ----------- | -------------------------------------------------- | ------------------- |
| çº¿æ€§æ ¸ï¼ˆLinearï¼‰ | $K(\mathbf x,\mathbf z)=\mathbf x^\top\mathbf z$   | ä¸æ˜ å°„ï¼Œé€€åŒ–ä¸ºçº¿æ€§ SVM       |
| å¤šé¡¹å¼æ ¸ï¼ˆPolyï¼‰  | $(\mathbf x^\top\mathbf z + r)^d$                  | å‚æ•°ï¼šé˜¶æ•° $d$ã€å¸¸æ•° $r$    |
| RBFï¼ˆé«˜æ–¯ï¼‰æ ¸    | $\exp\bigl(-\gamma\|\mathbf x-\mathbf z\|^2\bigr)$ | å‚æ•°ï¼š$\gamma>0$ï¼Œå±€éƒ¨ç›¸ä¼¼åº¦ |
| Sigmoid æ ¸   | $\tanh(\kappa\,\mathbf x^\top\mathbf z + \theta)$  | ç±»ä¼¼ç¥ç»ç½‘ç»œæ¿€æ´»å‡½æ•°          |

---

### ç¬¬4èŠ‚ï¼šè½¯é—´éš” SVMï¼ˆå®¹é”™åˆ†ç±»ï¼‰

#### 4.1 è½¯é—´éš”å¼•å…¥æ¾å¼›å˜é‡

* å¯¹æ¯ä¸ªæ ·æœ¬å¼•å…¥ $\xi_i\ge0$ï¼Œå…è®¸è¿ä¾‹
* çº¦æŸè°ƒæ•´ä¸º $y_i(\mathbf w^\top \mathbf x_i + b)\ge1-\xi_i$ã€‚

#### 4.2 ä¼˜åŒ–ç›®æ ‡

$$
\min_{\mathbf w,b,\boldsymbol\xi}
\;\frac12\|\mathbf w\|^2 + C\sum_{i=1}^N \xi_i
\quad
\text{s.t.}\;
y_i(\mathbf w^\top \mathbf x_i + b)\ge1-\xi_i,\;\xi_i\ge0.
$$

* **å‚æ•° $C$**ï¼šæƒè¡¡é—´éš”å¤§å°ä¸è¿ä¾‹æƒ©ç½šï¼Œ$C$ è¶Šå¤§ï¼Œè¶Šå€¾å‘äºç¡¬é—´éš”ï¼›$C$ è¶Šå°ï¼Œæ›´å®¹å¿è¿ä¾‹ã€‚

---

#### 4.3 å¯¹å¶å½¢å¼åŠæ ¸åŒ–

* åŒæ ·å¯æ¨å¯¼å« $C$ çš„å¯¹å¶é—®é¢˜ï¼Œæ ¸å‡½æ•°ç›´æ¥æ›¿æ¢ $\mathbf x_i^\top \mathbf x_j$ã€‚

$$
\boxed{
\begin{aligned}
&\max_{\boldsymbol\alpha}
\quad
\sum_{i=1}^N \alpha_i
- \tfrac12 \sum_{i,j} \alpha_i\alpha_j\,y_i y_j\,(x_i^\top x_j),\\
&\text{s.t.}\quad
\sum_i \alpha_i y_i = 0,
\quad
0 \le \alpha_i \le C,\quad i=1,\dots,N.
\end{aligned}
}
$$

* ä¸ç¡¬é—´éš” SVM çš„å”¯ä¸€åŒºåˆ«ï¼šé¢å¤–çš„ä¸Šç•Œ $\alpha_i\le C$ã€‚
* è¿™ä¿è¯äº†å³ä½¿æŸç‚¹æƒ³è´¡çŒ®å¾ˆå¤§ï¼Œä¹Ÿåªèƒ½è´¡çŒ®åˆ° $C$ çš„ç¨‹åº¦ï¼Œå¤šä½™çš„â€œçŠ¯é”™æƒ©ç½šâ€å½’åˆ° $\xi$ ä¸Šã€‚

---

### ç¬¬5èŠ‚ï¼šå¤šç±» SVM ä¸å®è·µ

#### 5.1 å¤šç±» SVM ç­–ç•¥

* **ä¸€å¯¹å¤šï¼ˆOne-vs-Restï¼‰**ï¼šé’ˆå¯¹æ¯ä¸ªç±»è®­ç»ƒä¸€ä¸ªäºŒåˆ†ç±» SVM
* **ä¸€å¯¹ä¸€ï¼ˆOne-vs-Oneï¼‰**ï¼šæ¯ä¸¤ç±»é—´è®­ç»ƒä¸€ä¸ª SVMï¼Œå…± $K(K-1)/2$ ä¸ªåˆ†ç±»å™¨
* scikit-learn é»˜è®¤é‡‡ç”¨ä¸€å¯¹å¤šç­–ç•¥ã€‚

#### 5.2 scikit-learn ç¤ºä¾‹

```python
from sklearn import datasets
from sklearn.model_selection import train_test_split, GridSearchCV
from sklearn.svm import SVC
from sklearn.metrics import classification_report, ConfusionMatrixDisplay

# åŠ è½½æ•°æ®
X, y = datasets.load_iris(return_X_y=True)
X_train, X_test, y_train, y_test = train_test_split(
    X, y, test_size=0.3, random_state=42
)

# å‚æ•°è°ƒä¼˜
param_grid = [
    {'kernel': ['linear'], 'C': [0.1, 1, 10]},
    {'kernel': ['rbf'], 'C': [0.1, 1, 10], 'gamma': [0.1, 1, 10]},
]
grid = GridSearchCV(SVC(), param_grid, cv=5)
grid.fit(X_train, y_train)
print("Best params:", grid.best_params_)

# è¯„ä¼°
y_pred = grid.predict(X_test)
print(classification_report(y_test, y_pred))
ConfusionMatrixDisplay.from_estimator(grid, X_test, y_test)
```

