---
marp: true
theme: default
paginate: true
math: katex
---

<style>
section {
  font-family: "Microsoft YaHei", "PingFang SC", "Source Han Sans", "Noto Sans CJK SC", sans-serif;
}
</style>

## <!-- fit -->ğŸ“˜ ç¬¬3è¬›ï¼šå‹¾é…é™ä¸‹æ³•ï¼ˆGradient Descentï¼‰

---

## âœ… 1. ã‚·ãƒŠãƒªã‚ªå°å…¥ï¼šã€ä¸‹å±±ã€ã‹ã‚‰å§‹ã‚ã‚‹

### ğŸ§  å°å…¥è³ªå•ï¼š

> ã€Œã‚ãªãŸã¯å±±ã®é ‚ä¸Šã«ç«‹ã£ã¦ã„ã¦ã€å¤©å€™ãŒæ‚ªãã¦å‘¨ã‚ŠãŒè¦‹ãˆã¾ã›ã‚“ã€‚ã©ã†ã™ã‚Œã°æœ€çŸ­ã§å±±ã®ãµã‚‚ã¨ã«ãŸã©ã‚Šç€ã‘ã¾ã™ã‹ï¼Ÿã€

---

### ğŸ¯ æ¯”å–©ã®å°å…¥ï¼š

- ã‚ãªãŸã¯**è¤‡é›‘ãªåœ°å½¢é–¢æ•°**ã®ä¸Šã«ã„ã¦ã€å„ç‚¹ã«â€œé«˜ã•â€ãŒã‚ã‚Šã¾ã™ã€‚  
- åœ°å›³ã¯ã‚ã‚Šã¾ã›ã‚“ãŒã€â€œã©ã¡ã‚‰ãŒã‚ˆã‚Šæ€¥ã‹â€ã‚’è¶³ã§æ„Ÿã˜å–ã‚Œã¾ã™ã€‚  
- ãã“ã§æ¬¡ã®æˆ¦ç•¥ã‚’å–ã‚Šã¾ã™ï¼š  
  - **ç¾åœ¨åœ°ã®å‚¾ãï¼ˆå°é–¢æ•°ï¼‰ã‚’æ„Ÿã˜å–ã‚‹**  
  - **æœ€ã‚‚æ€¥ãªä¸‹ã‚Šæ–¹å‘ã¸å°‘ã—æ­©ã**  
  - **ã“ã‚Œã‚’ç¹°ã‚Šè¿”ã™**

---

### ğŸ“Œ æ¯”å–©ã®å¯¾å¿œï¼š

| ç™»å±±ã®èª²é¡Œ     | æ©Ÿæ¢°å­¦ç¿’ã®èª²é¡Œ               |
|--------------|------------------------------|
| å±±ã®é«˜ã•       | æå¤±é–¢æ•°ã®å€¤                 |
| ç¾åœ¨ã®åœ°ç‚¹     | ãƒ¢ãƒ‡ãƒ«ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ï¼ˆä¾‹ï¼š$w,b$ï¼‰|
| ä¸‹å±±ã™ã‚‹       | æå¤±ã‚’æ¸›ã‚‰ã™                 |
| å‚¾ãã®æ–¹å‘     | å‹¾é…                         |
| ä¸€æ­©è¸ã¿å‡ºã™   | ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®æ›´æ–°             |
| ä¸‹å±±ã®æˆåŠŸ     | æœ€é©è§£ï¼ˆæœ€å°æå¤±ï¼‰ã®ç™ºè¦‹     |

![bg right:45% 100%](https://s.ar8.top/img/picgo/20250429225534445.webp)

---

### ğŸ”‘ å°çµï¼š

> ã€Œã“ã‚ŒãŒ**å‹¾é…é™ä¸‹æ³•**ã®åŸºæœ¬ã‚¢ã‚¤ãƒ‡ã‚¢ï¼š**æå¤±é–¢æ•°ã®å‹¾é…ã«æ²¿ã£ã¦â€œé™ã‚Šç¶šã‘â€ã€æœ€é©è§£ã‚’æ¢ã™ã€‚**ã€

---

## âœ… 2. â€œå‹¾é…â€ã¨ã¯ä½•ã‹ï¼Ÿ

---

### âœ¨ 2.1 ä¸€æ¬¡å…ƒç©ºé–“ã§ï¼ˆå°æ•°ï¼‰

- å¾®åˆ†ã§å­¦ã¶å°æ•°ï¼š  
  $$f'(x) = \frac{d}{dx} f(x)$$  
  - ã‚ã‚‹ç‚¹ã§ã®â€œå‚¾ãâ€ã‚’è¡¨ã™ã€‚  
- å‹¾é…é™ä¸‹æ³•ã§ã®â€œå‹¾é…â€ã¯å°æ•°ãã®ã‚‚ã®ï¼š  
  - ä¾‹ï¼š$f(x) = (x-3)^2$ ã®å ´åˆ  
    $$f'(x) = 2(x - 3)$$  
    ç¾åœ¨ã® $x$ ãŒå¤§ãã„ã»ã©å‚¾ãã‚‚å¤§ãã„ã€‚  
- ã™ã¹ãã“ã¨ã¯ **è² ã®å‚¾ãæ–¹å‘ã«æ²¿ã£ã¦ $x$ ã‚’æ›´æ–°ã—ã€æœ€ä½ç‚¹ã«è¿‘ã¥ã** ã“ã¨ã€‚

---

### ğŸ§­ ä¸€æ¬¡å…ƒå‹¾é…é™ä¸‹ã®æµã‚Œï¼š

- åˆæœŸå€¤ $x_0 = 0$  
- å­¦ç¿’ç‡ $\alpha = 0.1$  
- æ›´æ–°å¼ï¼š  
  $$x_{t+1} = x_t - \alpha \cdot f'(x_t)$$

| t | $x_t$ | $f'(x_t)$ | $x_{t+1}$ |
|---|-------|-----------|-----------|
| 0 | 0     | -6        | 0.6       |
| 1 | 0.6   | -4.8      | 1.08      |
| 2 | 1.08  | -3.84     | 1.464     |
| â€¦ | â€¦     | â€¦         | â€¦         |

âœ… æœ€çµ‚çš„ã« $x=3$ï¼ˆæœ€å°å€¤ç‚¹ï¼‰ã«åæŸ

---

### ğŸ“ 2.2 å¤šæ¬¡å…ƒç©ºé–“ã§ï¼ˆãƒ™ã‚¯ãƒˆãƒ«å‹¾é…ï¼‰

é–¢æ•°ãŒï¼š

$$
f(w, b) = \frac{1}{n} \sum_{i=1}^{n} (y_i - (w x_i + b))^2
$$

- $w, b$ ã¯æœ€é©åŒ–ã™ã¹ãâ€œä½ç½®â€  
- å‹¾é…ã¯**ãƒ™ã‚¯ãƒˆãƒ«**ã§ã€å„æˆåˆ†ãŒâ€œãã®æ–¹å‘ã®æœ€æ€¥ä¸Šæ˜‡æ–¹å‘â€ã‚’ç¤ºã™  

å¤šæ¬¡å…ƒæ›´æ–°å¼ï¼š

$$
\boldsymbol{\theta}_{t+1} = \boldsymbol{\theta}_t - \alpha \cdot \nabla_{\boldsymbol{\theta}} f(\boldsymbol{\theta}_t)
$$

ã“ã“ã§ $\boldsymbol{\theta}=[w,b]$

---

### ğŸ“Œ å‹¾é…é™ä¸‹ã®ç›´æ„Ÿçš„ç†è§£

> å‹¾é…é™ä¸‹ã¯ã€Œç›®ã‚’é–‰ã˜ã¦æ–œé¢ã‚’è°·åº•ã¸ä¸‹ã‚‹ã€ãƒ—ãƒ­ã‚»ã‚¹ã€‚  
> - å‹¾é…ãŒé€²ã‚€ã¹ãæ–¹å‘ï¼ˆæ€¥ãªå‚ï¼‰ã‚’æ•™ãˆã¦ãã‚Œã‚‹  
> - å­¦ç¿’ç‡ãŒä¸€æ­©ã®å¤§ãã•ã‚’æ±ºã‚ã‚‹  
> - ç¹°ã‚Šè¿”ã™ã“ã¨ã§å¾ã€…ã«æœ€ä½ç‚¹ã¸è¿‘ã¥ã  

![50% 90%](https://s.ar8.top/img/picgo/20250430000057416.webp)

---

### âœ… å°çµï¼š

> ã€Œå‹¾é…ã¯é€²ã‚€ã¹ãæ–¹å‘ã‚’ç¤ºã™ã‚³ãƒ³ãƒ‘ã‚¹ã€å‹¾é…é™ä¸‹ã¯ãã®ã‚³ãƒ³ãƒ‘ã‚¹ã«å¾“ã„è°·åº•ï¼ˆæœ€å°æå¤±ï¼‰ã¸å‘ã‹ã†é“ã®ã‚Šã€‚ã€

---

# âœ… 3. å‹¾é…é™ä¸‹ã®ä»•çµ„ã¿

### ğŸ§­ 3.1 å‹¾é…é™ä¸‹ã®ãƒ•ãƒ­ãƒ¼ãƒãƒ£ãƒ¼ãƒˆï¼ˆ5ã‚¹ãƒ†ãƒƒãƒ—ï¼‰

ä»¥ä¸‹ã®æ“¬ä¼¼ã‚³ãƒ¼ãƒ‰ï¼å›³è§£ã§å…¨ä½“åƒã‚’ç¤ºã™ï¼š

```
1. ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ï¼ˆä¾‹ï¼šw,bï¼‰ã‚’åˆæœŸåŒ–
2. ä»¥ä¸‹ã‚’åæŸã™ã‚‹ã¾ã§ç¹°ã‚Šè¿”ã™ï¼š
   a. ç¾åœ¨ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã§äºˆæ¸¬å€¤ y_hat ã‚’è¨ˆç®—
   b. æå¤±é–¢æ•° L(w,b) ã‚’è¨ˆç®—
   c. ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã«é–¢ã™ã‚‹å‹¾é… âˆ‡L ã‚’æ±‚ã‚ã‚‹
   d. å‹¾é…ã®é€†æ–¹å‘ã«æ²¿ã£ã¦ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’æ›´æ–°
```

---

### ğŸ“‰ 3.2 æ•°å­¦çš„æ›´æ–°ãƒ«ãƒ¼ãƒ«ï¼ˆç·šå½¢å›å¸°ã‚’ä¾‹ã«ï¼‰

#### ãƒ¢ãƒ‡ãƒ«ä»®å®šï¼š

$$
\hat{y}_i = w x_i + b
$$

#### æå¤±é–¢æ•°ï¼ˆå¹³å‡äºŒä¹—èª¤å·®ï¼‰ï¼š

$$
L(w,b)
= \frac{1}{n}\sum_{i=1}^n (y_i - \hat{y}_i)^2
= \frac{1}{n}\sum_{i=1}^n (y_i - w x_i - b)^2
$$

---

#### åå°ï¼š

$$
\frac{\partial L}{\partial w}
= -\frac{2}{n}\sum_i x_i (y_i - \hat{y}_i)
$$

$$
\frac{\partial L}{\partial b}
= -\frac{2}{n}\sum_i (y_i - \hat{y}_i)
$$

---

#### æ›´æ–°å¼ï¼š

$$
w := w - \alpha \cdot \frac{\partial L}{\partial w},
\quad
b := b - \alpha \cdot \frac{\partial L}{\partial b}
$$

- $\alpha$ï¼šå­¦ç¿’ç‡  
- $n$ï¼šã‚µãƒ³ãƒ—ãƒ«æ•°  

---

### ğŸ“Œ 3.3 ãƒã‚¤ãƒ‘ãƒ¼ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®å½¹å‰²

#### ğŸ”§ å­¦ç¿’ç‡ $\alpha$

- å°ã•ã™ãã‚‹ã¨ï¼šåæŸãŒé…ã„  
- å¤§ãã™ãã‚‹ã¨ï¼šæŒ¯å‹•ã¾ãŸã¯ç™ºæ•£ã™ã‚‹å¯èƒ½æ€§  

âœ… ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹ï¼š**é©åˆ‡ã«è¨­å®šã—ã€å‹•çš„èª¿æ•´ã‚„æ¸›è¡°ã‚’æ¤œè¨**

---

#### ğŸ” ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³æ•°ï¼ˆEpochï¼‰

- 1 Epoch = å…¨ã‚µãƒ³ãƒ—ãƒ«ã§1å›ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿æ›´æ–°  
- é€šå¸¸ã€æ•°åï½æ•°åƒå›ç¹°ã‚Šè¿”ã™  
  - åæŸåˆ¤å®šï¼ˆæå¤±ã®å¤‰åŒ–ãŒå°ã•ã„ï¼‰  
  - æœ€å¤§ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å›æ•°åˆ°é”  

---

### ğŸ§  3.4 å‹¾é…é™ä¸‹ã®ç›´æ„Ÿçš„ã¾ã¨ã‚

> å‹¾é…é™ä¸‹ã¯ã€Œç›®ã‚’é–‰ã˜ã¦æ–œé¢ã‚’è°·åº•ã¸ä¸‹ã‚‹ã€ã‚ˆã†ãªã‚‚ã®ï¼š  
> - å‹¾é…ãŒæ–¹å‘ã‚’ç¤ºã™  
> - å­¦ç¿’ç‡ãŒä¸€æ­©ã®å¤§ãã•ã‚’åˆ¶å¾¡  
> - ç¹°ã‚Šè¿”ã—ã§æœ€ä½ç‚¹ã«è¿‘ã¥ã  

---

# âœ… 4. ç·šå½¢å›å¸°ã¸ã®å‹¾é…é™ä¸‹é©ç”¨ä¾‹ï¼ˆæ‰‹è¨ˆç®—1å›åˆ†ï¼‰

ä¸€å…ƒç·šå½¢å›å¸°ãƒ¢ãƒ‡ãƒ«ï¼š

$$
\hat{y}_i = w x_i + b
$$

åˆæœŸè¨­å®šï¼š

- $w=0,\; b=0$  
- ã‚µãƒ³ãƒ—ãƒ« $(x=2, y=10)$  
- å­¦ç¿’ç‡ $\alpha=0.1$

äºˆæ¸¬å€¤ã®è¨ˆç®—ï¼š

$$
\hat{y} = 0\cdot2 + 0 = 0
$$

---

èª¤å·®ã®è¨ˆç®—ï¼š

$$
e = y - \hat{y} = 10 - 0 = 10
$$

å‹¾é…ã®è¨ˆç®—ï¼š

$$
\frac{\partial L}{\partial w}
= -2x \cdot e
= -2\cdot2\cdot10 = -40
\quad\Rightarrow\quad
w := 0 - 0.1\cdot(-40) = 4.0
$$

$$
\frac{\partial L}{\partial b}
= -2\cdot e = -20
\quad\Rightarrow\quad
b := 0 - 0.1\cdot(-20) = 2.0
$$

âœ… 1å›ã®æ›´æ–°å¾Œã€$w=4,\; b=2$ ã«è¿‘ã¥ã„ãŸï¼

---

## ğŸ“Œ å°çµ

| å†…å®¹         | è¦ç‚¹                                        |
|-------------|---------------------------------------------|
| æå¤±é–¢æ•°     | $(y - \hat{y})^2$ ã‚’æœ€å°åŒ–                  |
| å‹¾é…         | ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã«å¯¾ã™ã‚‹èª¤å·®ã®å°æ•°                |
| æ›´æ–°ãƒ«ãƒ¼ãƒ«   | $\theta := \theta - \alpha\cdot\nabla_\theta$ |
| ãƒ¡ãƒªãƒƒãƒˆ     | è¡Œåˆ—ã®é€†è¡Œåˆ—ä¸è¦ã€‚å¤§è¦æ¨¡ãƒ‡ãƒ¼ã‚¿ã«é©åˆ         |

---

# âœ… ç¬¬5éƒ¨ï¼šNumPyã§ç·šå½¢å›å¸°ã®å‹¾é…é™ä¸‹ã‚’å®Ÿè£…

## ğŸ§© ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ‡ãƒ¼ã‚¿ï¼ˆè¨“ç·´ãƒ‡ãƒ¼ã‚¿ï¼‰

é¢ç©ï¼‹éšæ•° â†’ ä¾¡æ ¼ ã®ç°¡å˜ãªç·šå½¢ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã‚’ä½¿ç”¨

---

## ğŸ“Œ ã¾ã¨ã‚

| é …ç›®       | èª¬æ˜                                       |
|-----------|--------------------------------------------|
| å‹¾é…è¨ˆç®—   | èª¤å·®ã®é€†ä¼æ’­ã§æœ€ã‚‚é‡è¦                      |
| é‡ã¿æ›´æ–°   | å‹¾é…ã®é€†æ–¹å‘Ã—å­¦ç¿’ç‡ã§èª¿æ•´                  |
| åæŸåˆ¤å®š   | æå¤±ã®å®‰å®šåº¦åˆã„ã§ç¢ºèª                      |
| è§£é‡ˆå¯èƒ½æ€§ | å„é‡ã¿ãŒç‰©ç†çš„ã«æ„å‘³ã‚’æŒã¤                  |

---

**æ¬¡å›äºˆå‘Šï¼š**  
> ğŸ” ãƒ­ã‚¸ã‚¹ãƒ†ã‚£ãƒƒã‚¯å›å¸°
