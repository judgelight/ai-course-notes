---
marp: true
theme: default
paginate: true
math: katex
---

<style>
section {
  font-family: "Microsoft YaHei", "PingFang SC", "Source Han Sans", "Noto Sans CJK SC", sans-serif;
}
</style>

## <!-- fit -->ğŸ“˜ ç¬¬7è®²ï¼šéç›‘ç£å­¦ä¹ -1

---

# ğŸ“ ç¬¬1èŠ‚ï¼šä»€ä¹ˆæ˜¯èšç±»ï¼Ÿ

---

1. **å›é¡¾**

   * åœ¨ç›‘ç£å­¦ä¹ ä¸­ï¼Œæˆ‘ä»¬æœ‰ $X$ å’Œæ ‡ç­¾ $y$ï¼Œç”¨æ¥è®­ç»ƒæ¨¡å‹åšé¢„æµ‹ã€‚
   * ä½†åœ¨å¾ˆå¤šå®é™…åœºæ™¯ä¸­ï¼Œæ•°æ® **æ²¡æœ‰** æˆ– **éš¾ä»¥è·å–** æ ‡ç­¾ã€‚

2. **é—®é¢˜**

   > â€œå½“æˆ‘ä»¬æ‰‹é‡Œåªæœ‰ä¸€å † unlabeled æ•°æ®ï¼Œæƒ³è¦å‘ç°æ•°æ®ç»“æ„ã€åˆ†ç»„æˆ–å¼‚å¸¸æ—¶ï¼Œæ€ä¹ˆåŠï¼Ÿâ€

3. **ç­”æ¡ˆ**

   * **éç›‘ç£å­¦ä¹ **ï¼šä¸ä¾èµ–æ ‡ç­¾ï¼Œè‡ªåŠ¨æŒ–æ˜æ•°æ®ä¸­çš„æ½œåœ¨æ¨¡å¼ã€‚
   * **èšç±»ï¼ˆClusteringï¼‰**ï¼šæŠŠç›¸ä¼¼çš„æ ·æœ¬â€œåˆ†åˆ°ä¸€èµ·â€ï¼Œå½¢æˆè‹¥å¹²ä¸ªâ€œç°‡â€ã€‚

---

## 1.2 èšç±»çš„å®šä¹‰ä¸ç›´è§‚ç†è§£

1. **å®šä¹‰**

   > **èšç±»**æ˜¯ä¸€ç§å°†æ•°æ®åˆ’åˆ†æˆè‹¥å¹²ç»„çš„æŠ€æœ¯ï¼Œä½¿å¾—**åŒç»„å†…**æ ·æœ¬ç›¸ä¼¼åº¦é«˜ã€**ç»„é—´**å·®å¼‚å¤§ã€‚

2. **ç›´è§‚æ¯”å–»**

   * æŠŠæ‚ä¹±æ— åºçš„ç‰©å“ï¼Œæ ¹æ®å®ƒä»¬çš„ç‰¹å¾ï¼ˆé¢œè‰²ã€å½¢çŠ¶ã€æè´¨ï¼‰åˆ†ç®±æ‰“åŒ…ã€‚
   * æ¯”å¦‚ï¼šè¶…å¸‚é‡Œçš„å•†å“åˆ†é—¨åˆ«ç±»ã€å›¾ä¹¦é¦†æŒ‰ä¸»é¢˜åˆ†ç±»ã€‚

---

3. **å¯è§†åŒ–ç¤ºä¾‹**

   * ç”»ä¸€å¼ ç®€å•çš„äºŒç»´æ•£ç‚¹å›¾ï¼Œç”¨è‚‰çœ¼å¯ä»¥åˆ†è¾¨ 3 ç¾¤ç‚¹ã€‚
   * å°±æ˜¯è¦æ‰¾åˆ°ç±»ä¼¼çš„â€œåœˆâ€ï¼Œè®©ç”µè„‘ä¹Ÿèƒ½è‡ªåŠ¨å®Œæˆã€‚

![bg right:50% 90%](https://s.ar8.top/img/picgo/20250611170019343.webp)

---

## 1.3 èšç±» vs åˆ†ç±»ï¼šæ ¸å¿ƒåŒºåˆ«

|      | åˆ†ç±»ï¼ˆClassificationï¼‰ | èšç±»ï¼ˆClusteringï¼‰    |
| ---- | ------------------ | ----------------- |
| æ•°æ®   | $(X, y)$ æœ‰æ ‡ç­¾       | ä»… $X$ æ— æ ‡ç­¾         |
| ç›®æ ‡   | é¢„æµ‹å·²çŸ¥ç±»åˆ«             | å‘æ˜æœªçŸ¥ç»“æ„ã€åˆ†ç»„         |
| æ¨¡å‹è¾“å‡º | ç¦»æ•£æ ‡ç­¾ $y$           | ç°‡æ ‡ç­¾ï¼ˆ0,1,2â€¦ï¼‰ï¼Œæ— è¯­ä¹‰å«ä¹‰ |
| è¯„ä»·   | ç²¾åº¦ã€å¬å›ç‡ç­‰æœ‰æ ‡å‡†         | è½®å»“ç³»æ•°ã€ç°‡å†…æ–¹å·®ã€å¯è§†åŒ–     |

---

## 1.4 å¸¸è§èšç±»åº”ç”¨åœºæ™¯

1. **å®¢æˆ·åˆ†ç¾¤**

   * ç”µå•†æ ¹æ®è´­ä¹°è¡Œä¸ºæŠŠç”¨æˆ·åˆ†æˆâ€œé«˜ä»·å€¼â€â€œä¸­ä»·å€¼â€â€œæ½œåœ¨æµå¤±â€
   * æ— éœ€é¢„å…ˆæ ‡æ³¨ï¼Œç”¨äºç²¾å‡†è¥é”€

2. **å¼‚å¸¸æ£€æµ‹**

   * ç½‘ç»œæµé‡æ•°æ®èšç±»ï¼Œå‘ç°â€œå­¤ç«‹ç‚¹â€å¯èƒ½æ˜¯æ”»å‡»æˆ–æ•…éšœ
   * é‡‘èäº¤æ˜“èšç±»ï¼Œæ£€æµ‹æ¬ºè¯ˆ

---

3. **å›¾åƒ/æ–‡æ¡£åˆ†ç»„**

   * å°†ç›¸ä¼¼å›¾ç‰‡æ”¾ä¸€èµ·ï¼Œä¾¿äºç®¡ç†
   * æ–°é—»æ–‡ç« è‡ªåŠ¨åˆ†ç»„ï¼Œè¾…åŠ©ç¼–è¾‘

4. **é™ç»´ & å¯è§†åŒ–**

   * èšç±»åå†ç”¨ PCA/t-SNE å¯è§†åŒ–æ¯ä¸ªç°‡çš„åˆ†å¸ƒ

---

## 1.5 èšç±»çš„åŸºæœ¬æ€è·¯ä¸æµç¨‹

1. **é€‰æ‹©ç‰¹å¾**

   * å…ˆæŠŠåŸå§‹æ•°æ®è½¬æˆç‰¹å¾å‘é‡ï¼ˆå¦‚è´­ä¹°æ¬¡æ•°ã€æ¶ˆè´¹é‡‘é¢ï¼‰

2. **é€‰æ‹©è·ç¦»åº¦é‡**

   * æ¬§æ°è·ç¦»ã€ä½™å¼¦ç›¸ä¼¼åº¦ç­‰

3. **é€‰æ‹©èšç±»ç®—æ³•**

   * **K-Means**ï¼šæœ€å¸¸ç”¨ï¼Œé€Ÿåº¦å¿«
   * **å±‚æ¬¡èšç±»**ï¼šå¯ç”Ÿæˆæ ‘çŠ¶å›¾ï¼Œé€‚åˆå°æ•°æ®
   * **DBSCAN**ï¼šåŸºäºå¯†åº¦ï¼Œèƒ½è¯†åˆ«å™ªå£°

---

4. **æ‰§è¡Œèšç±»**

   * å¾—åˆ°æ¯ä¸ªæ ·æœ¬çš„â€œç°‡æ ‡ç­¾â€

5. **è¯„ä»·ä¸å¯è§†åŒ–**

   * è½®å»“ç³»æ•°ã€ç°‡å†…æ–¹å·®
   * æ•£ç‚¹å›¾ + ä¸åŒé¢œè‰²å±•ç¤ºç°‡åˆ’åˆ†

---

# ğŸ“ ç¬¬2èŠ‚ï¼š K-Means èšç±»

---

## 1. åŸç†æ¦‚è¿°

1. **ç›®æ ‡**ï¼šå°† $n$ ä¸ªæ ·æœ¬åˆ†æˆ $K$ ä¸ªç°‡ï¼Œä½¿å¾—åŒç°‡å†…æ ·æœ¬å½¼æ­¤â€œå°½é‡ç›¸ä¼¼â€ã€ä¸åŒç°‡é—´â€œå°½é‡ä¸åŒâ€ã€‚
2. **åº¦é‡ç›¸ä¼¼åº¦**ï¼šå¸¸ç”¨**æ¬§æ°è·ç¦»**

   $$
   d(\mathbf{x}, \mathbf{c}) = \|\mathbf{x} - \mathbf{c}\|_2
   $$
3. **æ ¸å¿ƒæ€æƒ³**ï¼š

   * ç»´æŠ¤ $K$ ä¸ªâ€œè´¨å¿ƒâ€ï¼ˆcentroidï¼‰$\{\mathbf{c}_1,\dots,\mathbf{c}_K\}$
   * äº¤æ›¿ä¸¤æ­¥ç›´è‡³æ”¶æ•›ï¼š

     1. **åˆ†é…**ï¼šæ¯ä¸ªæ ·æœ¬åˆ†é…åˆ°æœ€è¿‘è´¨å¿ƒ
     2. **æ›´æ–°**ï¼šæ¯ä¸ªç°‡çš„è´¨å¿ƒæ›´æ–°ä¸ºè¯¥ç°‡æ‰€æœ‰æ ·æœ¬çš„å¹³å‡å€¼

---

## 2. ç®—æ³•æµç¨‹

è¾“å…¥ï¼šæ•°æ®é›† $X={xâ‚,â€¦,xâ‚™}$ï¼Œç°‡æ•° K

1. éšæœºåˆå§‹åŒ– K ä¸ªè´¨å¿ƒ $câ‚,â€¦,c_K$ï¼ˆå¯éšæœºé€‰æ ·æœ¬æˆ– K-Means++ï¼‰
2. Repeat:
   a. Assignment Step:
      å¯¹æ¯ä¸ªæ ·æœ¬ $xáµ¢$ï¼Œè®¡ç®—è·ç¦» $d(xáµ¢, câ±¼)$ï¼Œ
      å°† $xáµ¢$ åˆ†é…ç»™æœ€è¿‘è´¨å¿ƒæ‰€å±ç°‡
   b. Update Step:
      å¯¹æ¯ä¸ªç°‡ jï¼Œæ›´æ–°è´¨å¿ƒï¼š
        $$
         câ±¼ â† (1/|Sâ±¼|) âˆ‘_{xáµ¢âˆˆSâ±¼} xáµ¢
        $$
3. ç›´åˆ°è´¨å¿ƒä¸å†å˜åŒ–æˆ–è¾¾åˆ°æœ€å¤§è¿­ä»£æ¬¡æ•°
è¾“å‡ºï¼šæ¯ä¸ªæ ·æœ¬çš„ç°‡æ ‡ç­¾ï¼Œä»¥åŠæœ€ç»ˆè´¨å¿ƒ

---

## 3. sklearn å®æˆ˜ç¤ºä¾‹

```python
import numpy as np
import matplotlib.pyplot as plt
from sklearn.datasets import make_blobs
from sklearn.cluster import KMeans

# 1. ç”Ÿæˆç¤ºä¾‹æ•°æ®
X, _ = make_blobs(n_samples=300, centers=4, cluster_std=0.8, random_state=0)

# 2. è®­ç»ƒ K-Means æ¨¡å‹
k = 4
km = KMeans(n_clusters=k, init='k-means++', random_state=42)
labels = km.fit_predict(X)
centers = km.cluster_centers_

# 3. å¯è§†åŒ–ç»“æœ
plt.figure(figsize=(6,5))
plt.scatter(X[:,0], X[:,1], c=labels, cmap='tab10', s=30, edgecolor='k', alpha=0.6)
plt.scatter(centers[:,0], centers[:,1], 
            c='red', marker='X', s=200, label='Centroids')
plt.title(f'K-Means Clustering (K={k})')
plt.xlabel('Feature 1'); plt.ylabel('Feature 2')
plt.legend()
plt.grid(True)
plt.show()
```

* **å‚æ•°è¯´æ˜**

  * `n_clusters`ï¼šç°‡æ•° $K$
  * `init='k-means++'`ï¼šåˆå§‹åŒ–æ–¹æ³•
  * `random_state`ï¼šéšæœºç§å­ï¼Œä¿è¯ç»“æœå¯å¤ç°

---

## 4. èšç±»æ•ˆæœè¯„ä¼°

### 4.1 è½®å»“ç³»æ•°ï¼ˆSilhouette Scoreï¼‰

$$
s(i) = \frac{b(i) - a(i)}{\max\{a(i), b(i)\}}
$$

* $a(i)$ï¼šæ ·æœ¬ $i$ ä¸åŒç°‡å†…å…¶ä»–æ ·æœ¬çš„å¹³å‡è·ç¦»
* $b(i)$ï¼šæ ·æœ¬ $i$ ä¸æœ€è¿‘é‚»ç°‡å†…æ ·æœ¬çš„å¹³å‡è·ç¦»

```python
from sklearn.metrics import silhouette_score
score = silhouette_score(X, labels)
print(f'Silhouette Score: {score:.3f}')
```

* **å–å€¼èŒƒå›´**ï¼š$-1$ åˆ° $+1$ï¼Œè¶Šæ¥è¿‘ $+1$ è¡¨ç¤ºèšç±»æ•ˆæœè¶Šå¥½

---

### 4.2 ç°‡å†…å¹³æ–¹å’Œï¼ˆInertiaï¼‰

åœ¨ `scikit-learn` çš„ `KMeans` æ¨¡å‹ä¸­ï¼Œå±æ€§ `inertia_` è¡¨ç¤º **ç°‡å†…å¹³æ–¹å’Œï¼ˆWithin-Cluster Sum of Squaresï¼ŒWCSSï¼‰**ï¼Œå³æ‰€æœ‰æ ·æœ¬åˆ°å„è‡ªç°‡è´¨å¿ƒçš„**æ¬§æ°è·ç¦»çš„å¹³æ–¹å’Œ**ï¼š

$$
\text{inertia\_} = \sum_{i=1}^{n} \min_{j=1..K} \|x_i - c_j\|^2
$$

* **å€¼è¶Šå°**ï¼šå„ç°‡å†…éƒ¨è¶Šç´§å‡‘ï¼Œèšç±»æ•ˆæœè¶Šå¥½ï¼ˆä½†è¿‡å°å¯èƒ½æ„å‘³ç€ç°‡æ•°è¿‡å¤šï¼‰ã€‚
* å¯ä»¥ç»“åˆâ€œè‚˜éƒ¨æ³•åˆ™â€ï¼ˆElbow Methodï¼‰é€šè¿‡ç»˜åˆ¶ `inertia_` éš `K` å˜åŒ–çš„æ›²çº¿ï¼Œæ¥é€‰å–åˆé€‚çš„ç°‡æ•°ã€‚

---

## ç¤ºä¾‹ä»£ç 

```python
import numpy as np
import matplotlib.pyplot as plt
from sklearn.datasets import make_blobs
from sklearn.cluster import KMeans

# 1. ç”Ÿæˆç¤ºä¾‹æ•°æ®
X, _ = make_blobs(n_samples=300, centers=4, cluster_std=0.8, random_state=42)

# 2. è®­ç»ƒä¸åŒç°‡æ•°çš„ KMeansï¼Œå¹¶æ”¶é›† inertia_
inertias = []
K_range = range(1, 10)
for k in K_range:
    km = KMeans(n_clusters=k, init='k-means++', random_state=42)
    km.fit(X)
    inertias.append(km.inertia_)

# 3. ç»˜åˆ¶è‚˜éƒ¨æ›²çº¿
plt.figure(figsize=(6,4))
plt.plot(K_range, inertias, 'o-', linewidth=2)
plt.title("Elbow Method: Inertia vs. Number of Clusters")
plt.xlabel("Number of clusters (K)")
plt.ylabel("Inertia (WCSS)")
plt.xticks(K_range)
plt.grid(True)
plt.show()
```

* `km.inertia_` åœ¨æ¯æ¬¡ `fit` ä¹‹åå³å¯è¯»å–ã€‚
* ä¸Šé¢ä»£ç æ¼”ç¤ºäº†å¦‚ä½•é’ˆå¯¹ä¸åŒçš„ `K` å€¼æ”¶é›† `inertia_`ï¼Œå¹¶ç»˜åˆ¶â€œè‚˜éƒ¨æ›²çº¿â€å¸®åŠ©æˆ‘ä»¬é€‰å–åˆé€‚çš„èšç±»æ•°ã€‚

---

## 5. ä¼˜ç¼ºç‚¹ä¸å®è·µå»ºè®®

| ä¼˜ç‚¹                 | ç¼ºç‚¹              |
| ------------------ | --------------- |
| å®ç°ç®€å•ã€æ•ˆç‡é«˜           | éœ€é¢„å…ˆæŒ‡å®šç°‡æ•° K       |
| å¯¹å¤§è§„æ¨¡æ•°æ®è¡¨ç°è‰¯å¥½ï¼ˆçº¿æ€§å¤æ‚åº¦ï¼‰  | å¯¹å™ªå£°ã€ç¦»ç¾¤ç‚¹æ•æ„Ÿ       |
| K-Means++ åˆå§‹åŒ–å¯åŠ é€Ÿæ”¶æ•› | åªé€‚åˆå‡¸å½¢ç°‡ï¼Œæ— æ³•å‘ç°ä»»æ„å½¢çŠ¶ |

**å®è·µå»ºè®®**ï¼š

* å…ˆç”¨æ‰‹è‚˜æ³•ï¼ˆElbow Methodï¼‰æˆ–è½®å»“ç³»æ•°ç¡®å®šåˆé€‚ $K$
* å¯¹æ•°æ®åšç¼©æ”¾/æ ‡å‡†åŒ–
* å¯¹å™ªå£°æ•æ„Ÿï¼Œå¯ç»“åˆ DBSCAN åšäºŒæ¬¡æ¸…æ´—

---

# ğŸ“ ç¬¬2èŠ‚ï¼šå±‚æ¬¡èšç±»ï¼ˆAgglomerative Clusteringï¼‰

---

## 1. åŸç†

### 1.1. è‡ªåº•å‘ä¸Š vs è‡ªé¡¶å‘ä¸‹

* **è‡ªåº•å‘ä¸Šï¼ˆAgglomerativeï¼‰**

  1. åˆå§‹æ—¶ï¼šæ¯ä¸ªæ ·æœ¬å„è‡ªæˆç°‡ï¼Œå…±æœ‰ $n$ ä¸ªç°‡ã€‚
  2. è¿­ä»£åˆå¹¶ï¼šä¸æ–­å°†â€œæœ€ç›¸ä¼¼â€çš„ä¸¤ä¸ªç°‡åˆå¹¶æˆä¸€ä¸ªæ–°ç°‡ã€‚
  3. ç›´åˆ°ç°‡æ•°é™åˆ°ç›®æ ‡ $K$ æˆ–æ‰€æœ‰æ ·æœ¬åˆå¹¶ä¸ºå•ä¸€ç°‡ã€‚

* **è‡ªé¡¶å‘ä¸‹ï¼ˆDivisiveï¼‰**

  1. åˆå§‹æ—¶ï¼šæ‰€æœ‰æ ·æœ¬åœ¨ä¸€ä¸ªç°‡ä¸­ã€‚
  2. è¿­ä»£æ‹†åˆ†ï¼šä¸æ–­é€‰æ‹©ä¸€ä¸ªç°‡ï¼Œå°†å®ƒæ‹†åˆ†æˆä¸¤ä¸ªå­ç°‡ã€‚
  3. ç›´åˆ°å¾—åˆ°ç›®æ ‡ç°‡æ•°ã€‚

æœ¬èŠ‚é‡ç‚¹è®² **è‡ªåº•å‘ä¸Š**ã€‚

---

### 1.2. â€œæœ€è¿‘â€å¦‚ä½•å®šä¹‰ï¼šLinkage è®¡ç®—æ–¹å¼

åœ¨æ¯ä¸€æ­¥ï¼Œæˆ‘ä»¬éƒ½è¦åœ¨å½“å‰çš„ç°‡é›†åˆä¸­å¯»æ‰¾ä¸€å¯¹â€œæœ€è¿‘â€çš„ç°‡ $A, B$ åˆå¹¶ã€‚å…³é”®åœ¨äºå®šä¹‰â€œç°‡é—´è·ç¦»â€ $D(A, B)$ã€‚å¸¸è§æœ‰ï¼š

#### 1.2.1 å•é“¾æ¥ï¼ˆSingle Linkageï¼‰

$$
D_{\text{single}}(A, B) 
= \min_{x \in A,\; y \in B} \; d(x, y)
$$

* å–ä¸¤ç°‡ä¸­æ‰€æœ‰æ ·æœ¬å¯¹ä¹‹é—´çš„æœ€å°è·ç¦»ã€‚
* å®¹æ˜“äº§ç”Ÿâ€œé“¾å¼æ•ˆåº”â€ï¼Œç°‡å¯èƒ½æ‹‰é•¿ã€‚

---

#### 1.2.2 å…¨é“¾æ¥ï¼ˆComplete Linkageï¼‰

$$
D_{\text{complete}}(A, B) 
= \max_{x \in A,\; y \in B} \; d(x, y)
$$

* å–ä¸¤ç°‡ä¸­æ‰€æœ‰æ ·æœ¬å¯¹ä¹‹é—´çš„æœ€å¤§è·ç¦»ã€‚
* å€¾å‘ç”Ÿæˆå½¢çŠ¶æ›´ç´§å‡‘çš„ç°‡ã€‚


#### 1.2.3 å¹³å‡é“¾æ¥ï¼ˆAverage Linkageï¼‰

$$
D_{\text{average}}(A, B) 
= \frac{1}{|A|\;|B|} 
  \sum_{x \in A} \sum_{y \in B} d(x, y)
$$

* å–ä¸¤ç°‡ä¸­æ‰€æœ‰æ ·æœ¬å¯¹è·ç¦»çš„ç®—æœ¯å¹³å‡ã€‚
* åœ¨å•/å…¨é“¾æ¥ä¹‹é—´å–å¾—å¹³è¡¡ã€‚

---

### 1.2.4 Wardâ€™s æ–¹æ³•ï¼ˆæœ€å°æ–¹å·®å¢é‡ï¼‰

Ward æ–¹æ³•ä¸æ˜¯ç›´æ¥åŸºäºä¸åŒç°‡æ ·æœ¬é—´è·ç¦»ï¼Œè€Œæ˜¯åŸºäºç°‡å†…æ–¹å·®å¢é‡ï¼š

1. å®šä¹‰ç°‡ $C$ çš„ä»£ä»·ï¼ˆè¯¯å·®å¹³æ–¹å’Œï¼‰ï¼š

$$
   \mathrm{SSE}(C)
   = \sum_{x \in C} \|x - \mu_C\|^2,
   \quad \mu_C = \frac{1}{|C|} \sum_{x \in C} x
$$

2. åˆå¹¶ $A,B$ åå¢é‡ï¼š

   $$
   \Delta(A, B)
   = \mathrm{SSE}(A \cup B) - \mathrm{SSE}(A) - \mathrm{SSE}(B)
   $$

3. é€‰æ‹©ä½¿ $\Delta(A, B)$ **æœ€å°** çš„ä¸€å¯¹ç°‡è¿›è¡Œåˆå¹¶ã€‚

Ward æ–¹æ³•ç­‰ä»·äº**æœ€å°åŒ–ç°‡å†…çš„æ€»æ–¹å·®**ï¼Œé€šå¸¸äº§ç”Ÿè¾ƒå‡è¡¡çš„ç°‡ã€‚

---

## 1.3. ç®—æ³•è¯¦ç»†æµç¨‹

1. **åˆå§‹åŒ–**

   * æ¯ä¸ªæ ·æœ¬ $x_i$ è‡ªæˆä¸€ä¸ªç°‡ï¼›å…±æœ‰ $n$ ä¸ªç°‡ $\{C_1, \dots, C_n\}$ã€‚

2. **é‡å¤ä»¥ä¸‹æ­¥éª¤**
   a. **è®¡ç®—ç°‡é—´è·ç¦»çŸ©é˜µ** $\{D(C_i, C_j)\}$ï¼ˆä»»é€‰ä¸€ç§ Linkageï¼‰
   b. æ‰¾å‡ºè·ç¦»æœ€å°çš„ä¸€å¯¹ç°‡ $(C_p, C_q)$
   c. å°†å®ƒä»¬åˆå¹¶æˆæ–°ç°‡

   $$
   C_{\text{new}} = C_p \cup C_q
   $$

   d. ä»ç°‡åˆ—è¡¨ä¸­ç§»é™¤ $C_p, C_q$ï¼ŒåŠ å…¥ $C_{\text{new}}$ã€‚
   e. æ›´æ–°è·ç¦»çŸ©é˜µï¼šå¯¹æ‰€æœ‰å…¶ä»–ç°‡ $C_k$ é‡æ–°è®¡ç®—
   $\;D(C_{\text{new}}, C_k)$ï¼ˆæ ¹æ® Linkage å…¬å¼ï¼‰ã€‚

---

3. **ç»“æŸæ¡ä»¶**

   * å½“å‰©ä½™ç°‡æ•° $= K$ æ—¶åœæ­¢ï¼Œæˆ–è€…åˆå¹¶åˆ°å•ç°‡ã€‚

4. **ç»“æœ**

   * æ¯ä¸ªåŸå§‹æ ·æœ¬å¾—åˆ°ä¸€ä¸ªç°‡æ ‡ç­¾ã€‚
   * ä¸­é—´åˆå¹¶å†å²å¯ç”¨äºç»˜åˆ¶æ ‘çŠ¶å›¾ï¼ˆDendrogramï¼‰ã€‚

---

## 2. Dendrogramï¼ˆæ ‘çŠ¶å›¾ï¼‰ç®€ä»‹

* **æ ‘çŠ¶å›¾** å±•ç¤ºäº†æ¯æ¬¡åˆå¹¶çš„é¡ºåºä¸è·ç¦»
* æ¨ªè½´ï¼šæ ·æœ¬ç´¢å¼•æˆ–ç°‡ï¼›çºµè½´ï¼šåˆå¹¶è·ç¦»ï¼ˆç›¸ä¼¼åº¦çš„åé‡ï¼‰
* å¯ä»¥ç›´è§‚åœ°**é€‰æ‹©æˆªæ–­é«˜åº¦**æ¥ç¡®å®šèšç±»æ•°

![bg right:50% 100%](https://s.ar8.top/img/picgo/20250611193029257.webp)

---

## 3. sklearn å®æˆ˜

```python
from sklearn.cluster import AgglomerativeClustering
import matplotlib.pyplot as plt

# å‡å®šå·²æœ‰ X (n_samples, 2) çš„æ•°æ®
for linkage_method in ['single', 'complete', 'average', 'ward']:
    agg = AgglomerativeClustering(n_clusters=3, linkage=linkage_method)
    labels = agg.fit_predict(X)
    plt.figure(figsize=(4,4))
    plt.scatter(X[:,0], X[:,1], c=labels, cmap='tab10', s=30, edgecolor='k')
    plt.title(f"Agglomerative (linkage={linkage_method})")
    plt.show()
```

* **æ³¨æ„**ï¼š`ward` ä»…é€‚ç”¨äºæ¬§æ°è·ç¦»ï¼›å…¶ä»–é“¾æ¥å¯é…åˆä»»æ„åº¦é‡ã€‚

---

## 4. é“¾æ¥æ–¹å¼å¯¹æ¯”

| Linkage  | ç‰¹ç‚¹                   | é€‚ç”¨åœºæ™¯                 |
| -------- | -------------------- | -------------------- |
| single   | èšç°‡æ˜“è¢«â€œé“¾å¼â€è¿æ¥ï¼Œå¯èƒ½äº§ç”Ÿâ€œé•¿æ¡â€ç°‡ | å™ªå£°è¾ƒå¤šæ—¶ä¸å¤ªç†æƒ³            |
| complete | ç°‡å†…æœ€è¿œè·ç¦»æœ€å°åŒ–ï¼Œç°‡å½¢ç´§å‡‘       | å¸Œæœ›è¾ƒå‡åŒ€ç°‡å½¢              |
| average  | ç»¼åˆè€ƒè™‘æ‰€æœ‰ç‚¹å¯¹è·ç¦»           | å¹³è¡¡ single ä¸ complete |
| ward     | æœ€å°åŒ–ç°‡é—´æ–¹å·®å¢é‡            | æ¬§æ°ç©ºé—´ã€å‡¸å½¢ç°‡æœ€ä½³           |


* single ä¼šå½¢æˆè¿é”æ•ˆåº”
* complete æ•ˆæœæ›´åœ†å½¢
* ward æœ€ç¨³å¥

---

## 5. èšç±»æ•ˆæœè¯„ä¼°

1. **è½®å»“ç³»æ•°ï¼ˆSilhouette Scoreï¼‰**

   ```python
   from sklearn.metrics import silhouette_score
   score = silhouette_score(X, labels)
   print(score)
   ```
2. **Calinski-Harabasz åˆ†æ•°** / **Daviesâ€“Bouldin æŒ‡æ•°**

è§£é‡Šï¼šæ— æ ‡ç­¾èšç±»è¯„ä»·éœ€ç”¨**å†…éƒ¨æŒ‡æ ‡**ï¼Œå¸®åŠ©é€‰æ‹©é“¾æ¥æ–¹å¼å’Œç°‡æ•°ã€‚

