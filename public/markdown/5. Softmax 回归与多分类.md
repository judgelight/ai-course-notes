---
marp: true
theme: default
paginate: true
math: katex
---

<style>
section {
  font-family: "Microsoft YaHei", "PingFang SC", "Source Han Sans", "Noto Sans CJK SC", sans-serif;
}
</style>

## <!-- fit -->ğŸ“˜ ç¬¬5è®²ï¼šSoftmax å›å½’ä¸å¤šåˆ†ç±»

---

# ğŸ“ ç¬¬1èŠ‚ï¼šé—®é¢˜å¼•å…¥ä¸å¤šåˆ†ç±»åœºæ™¯

> â€œæˆ‘ä»¬ä¹‹å‰å­¦äº†é€»è¾‘å›å½’ï¼Œå¯ä»¥è§£å†³äºŒåˆ†ç±»é—®é¢˜ï¼šæ˜¯ / å¦ï¼Œæ­£ç±» / è´Ÿç±»â€¦â€¦
> é‚£å¦‚æœæœ‰ 3 ä¸ªã€10 ä¸ªï¼Œç”šè‡³ 100 ä¸ªç±»åˆ«å‘¢ï¼Ÿé€»è¾‘å›å½’è¿˜å¤Ÿç”¨å—ï¼Ÿâ€

---

## ğŸ“Œ ä¸¾å‡ ä¸ªå®é™…æ¡ˆä¾‹ï¼š

### ğŸ¶ å›¾åƒè¯†åˆ«ï¼ˆ3 ç±»ï¼‰ï¼š

* è¾“å…¥ï¼šä¸€å¼ å›¾ç‰‡ï¼ˆç‰¹å¾å‘é‡ï¼‰
* è¾“å‡ºï¼šæ˜¯ç‹— / çŒ« / é¸Ÿä¸­çš„å“ªä¸€ç±»ï¼Ÿ

æˆ‘ä»¬ä¸æƒ³åªçŸ¥é“â€œæ˜¯ä¸æ˜¯çŒ«â€ï¼Œè€Œæ˜¯æƒ³çŸ¥é“å®ƒ**å±äºå“ªä¸ªç±»åˆ«**ã€‚

---

### ğŸ“° æ–°é—»æ–‡æœ¬åˆ†ç±»ï¼ˆ4 ç±»ï¼‰ï¼š

* è¾“å…¥ï¼šä¸€ç¯‡æ–°é—»æ–‡ç« ï¼ˆç»è¿‡å‘é‡åŒ–å¤„ç†ï¼‰
* è¾“å‡ºï¼šå®ƒå±äºä½“è‚² / ç§‘æŠ€ / å¨±ä¹ / è´¢ç» å“ªä¸€ä¸ªï¼Ÿ

---

### ğŸ§ª æ•…éšœä»£ç è¯†åˆ«ï¼ˆå¤šç±»åˆ«ï¼‰ï¼š

* è¾“å…¥ï¼šæŸè®¾å¤‡çš„ä¼ æ„Ÿå™¨æ•°æ®
* è¾“å‡ºï¼šå¯èƒ½æ˜¯æ•…éšœä»£ç  100 / 200 / 300 / 999 ä¸­çš„å“ªä¸€ä¸ªï¼Ÿ

---

## âœ… 1.2 ä¸ºä»€ä¹ˆé€»è¾‘å›å½’ä¸å¤Ÿç”¨ï¼Ÿ

é€»è¾‘å›å½’çš„è¾“å‡ºæ˜¯ï¼š

$$
\hat{y} = \sigma(w^T x + b) \in (0, 1)
$$

è¡¨ç¤ºæ˜¯â€œæŸä¸ªç‰¹å®šç±»åˆ«â€çš„æ¦‚ç‡ï¼ˆå¦‚å±äº 1 ç±» vs é 1 ç±»ï¼‰ï¼Œåªèƒ½å¤„ç†ï¼š

* **ä¸¤ä¸ªç±»åˆ«**ï¼ˆæ­£ç±» / è´Ÿç±»ï¼‰
* ä¸é€‚åˆå¤šä¸ªäº’æ–¥ç±»åˆ«ï¼ˆå¦‚ç‹—ã€çŒ«ã€é¸Ÿï¼‰

---

## âŒ å°è¯•é”™è¯¯æ–¹æ³•ï¼šå¤šä¸ªé€»è¾‘å›å½’ç»„åˆ

æœ‰åŒå­¦å¯èƒ½ä¼šè¯´ï¼š

> â€œæˆ‘ä»¬å¯ä»¥è®­ç»ƒå¤šä¸ªé€»è¾‘å›å½’æ¨¡å‹ï¼šåˆ†åˆ«é¢„æµ‹æ˜¯ä¸æ˜¯çŒ«ï¼Œæ˜¯ä¸æ˜¯ç‹—ï¼Œæ˜¯ä¸æ˜¯é¸Ÿâ€

ä½†æ˜¯ä¼šå‡ºç°è¿™äº›é—®é¢˜ï¼š

| é—®é¢˜          | è¯´æ˜                  |
| ----------- | ------------------- |
| âœ… ä¸äº’æ–¥       | æ¨¡å‹å¯èƒ½åŒæ—¶è¯´â€œåƒçŒ«â€ä¹Ÿâ€œåƒç‹—â€    |
| ğŸ“‰ æ¦‚ç‡æ— æ³•å½’ä¸€åŒ–  | æ‰€æœ‰è¾“å‡ºåŠ èµ·æ¥å¯èƒ½ > 1 æˆ– < 1 |
| âŒ æ— æ³•é€‰å‡ºæœ€å¯èƒ½ç±»åˆ« | ç¼ºå°‘ç»Ÿä¸€æ ‡å‡†è¿›è¡Œé€‰æ‹©          |

---

## âœ… æ­£ç¡®æ€è·¯ï¼šéœ€è¦**ä¸€ä¸ªèƒ½è¾“å‡ºå¤šä¸ªç±»åˆ«æ¦‚ç‡**çš„å‡½æ•°

> æˆ‘ä»¬æƒ³è¦çš„æ˜¯ï¼š
> **ç»™å®šä¸€ä¸ªè¾“å…¥ $x$ï¼Œè¾“å‡ºä¸€ä¸ª K ç»´å‘é‡ï¼Œè¡¨ç¤ºå±äºæ¯ä¸ªç±»åˆ«çš„æ¦‚ç‡**

* è¾“å‡ºåº”è¯¥æ˜¯ï¼š

  $$
  \hat{y} = [0.1, 0.7, 0.2]
  $$
* è¿™äº›æ¦‚ç‡å¿…é¡»æ˜¯ï¼š

  * éè´Ÿ
  * æ€»å’Œä¸º 1ï¼ˆå½¢æˆä¸€ä¸ªåˆ†å¸ƒï¼‰

è¿™æ—¶ï¼Œ**Softmax å‡½æ•°**åº”è¿è€Œç”Ÿã€‚

---

# ğŸ“ ç¬¬2èŠ‚ï¼šSoftmax å‡½æ•°çš„å®šä¹‰ä¸æ€§è´¨

---

## âœ… 2.1 Softmax æ˜¯ä»€ä¹ˆ

> Softmax æ˜¯ä¸€ä¸ªå°† **ä»»æ„å®æ•°å‘é‡** æ˜ å°„æˆ **æ¦‚ç‡åˆ†å¸ƒ** çš„å‡½æ•°ã€‚

### ğŸ“ æ•°å­¦å®šä¹‰ï¼š

å¯¹äºä¸€ä¸ªé•¿åº¦ä¸º $K$ çš„å®æ•°å‘é‡ $z = [z_1, z_2, ..., z_K]$ï¼ŒSoftmax å‡½æ•°å®šä¹‰ä¸ºï¼š

$$
\text{Softmax}(z_i) = \frac{e^{z_i}}{\sum_{j=1}^{K} e^{z_j}} \quad \text{for } i = 1, ..., K
$$

æ¯ä¸€ä¸ªè¾“å‡º $\hat{y}_i$ è¡¨ç¤ºï¼š**è¾“å…¥å±äºç¬¬ $i$ ç±»çš„æ¦‚ç‡**

---

## âœ… 2.2 Softmax çš„è¾“å‡ºæ€§è´¨

### ğŸ“Œ ç‰¹ç‚¹ 1ï¼šæ¯ä¸€ç»´éƒ½æ˜¯éè´Ÿ

$$
\text{Softmax}(z_i) > 0 \quad \text{å› ä¸º } e^{z_i} > 0
$$

---

### ğŸ“Œ ç‰¹ç‚¹ 2ï¼šæ‰€æœ‰ç»´åº¦ä¹‹å’Œç­‰äº 1ï¼ˆå½¢æˆæ¦‚ç‡åˆ†å¸ƒï¼‰

$$
\sum_{i=1}^K \text{Softmax}(z_i) = 1
$$

æ‰€ä»¥ Softmax çš„è¾“å‡ºå¯ä»¥è§£é‡Šä¸ºï¼š**å±äºå„ç±»çš„æ¦‚ç‡**

---

### ğŸ“Œ ç‰¹ç‚¹ 3ï¼šè¾“å…¥å·®å¼‚è¶Šå¤§ï¼Œè¾“å‡ºè¶Šâ€œæç«¯â€

* è‹¥ä¸€ä¸ª $z_i$ æ˜æ˜¾å¤§äºå…¶ä»–å€¼ï¼Œåˆ™ Softmax è¾“å‡ºä¼šéå¸¸æ¥è¿‘ one-hotï¼š

  $$
  \text{Softmax}(10, 0, 0) \approx [0.999, 0.0004, 0.0004]
  $$
* è‹¥è¾“å…¥ç›¸å·®ä¸å¤§ï¼Œè¾“å‡ºæ›´â€œå¹³æ»‘â€ï¼š

  $$
  \text{Softmax}(1, 1, 1) = [0.33, 0.33, 0.33]
  $$

âœ… è¿™æ­£æ˜¯æˆ‘ä»¬æƒ³è¦çš„åˆ†ç±»è¡Œä¸ºï¼š**â€œè¶Šè‡ªä¿¡ï¼Œè¶Šæç«¯â€**

---

## âœ… 2.3 Softmax æ˜¯ Sigmoid çš„æ¨å¹¿

å¦‚æœä½ åªé¢„æµ‹ 2 ä¸ªç±»åˆ«ï¼š

* è¾“å…¥ï¼š$z = [z_1, z_2]$
* Softmax è¾“å‡ºï¼š

  $$
  \hat{y}_1 = \frac{e^{z_1}}{e^{z_1} + e^{z_2}} \quad,\quad
  \hat{y}_2 = \frac{e^{z_2}}{e^{z_1} + e^{z_2}}
  $$

è®¾ $z = z_1 - z_2$ï¼Œä½ ä¼šå¾—åˆ°ï¼š

$$
\hat{y}_1 = \frac{1}{1 + e^{-z}} = \text{Sigmoid}(z)
$$

ğŸ“Œ æ‰€ä»¥ **Softmax æ˜¯ Sigmoid çš„å¤šç±»ç‰ˆæœ¬**

---

## âœ… å°ç»“

| ç‰¹æ€§ | Softmax                                        |
| -- | ---------------------------------------------- |
| è¾“å…¥ | ä»»æ„å®æ•°å‘é‡ $z \in \mathbb{R}^K$                    |
| è¾“å‡º | æ¦‚ç‡åˆ†å¸ƒ $\hat{y} \in (0,1)^K, \sum \hat{y}_i = 1$ |
| ç”¨é€” | å¤šç±»åˆ«åˆ†ç±»ä»»åŠ¡                                        |
| å¯¹æ¯” | æ˜¯ sigmoid çš„å¤šç±»æ‰©å±•ç‰ˆæœ¬                              |

---

# ğŸ“ ç¬¬3èŠ‚ï¼šæ¨¡å‹ç»“æ„ä¸äº¤å‰ç†µæŸå¤±å‡½æ•°

---

## âœ… 3.1 æ¨¡å‹ç»“æ„å›é¡¾

### å¤šåˆ†ç±»é€»è¾‘ç»“æ„ï¼š

æˆ‘ä»¬è¦åšçš„äº‹æƒ…æ˜¯ä»è¾“å…¥ç‰¹å¾ $x \in \mathbb{R}^d$ï¼Œé¢„æµ‹å±äº $K$ ä¸ªç±»åˆ«ä¸­å“ªä¸€ä¸ªã€‚

### ğŸ“ æ¨¡å‹å…¬å¼ï¼š

$$
\hat{y} = \text{Softmax}(Wx + b)
$$

å…¶ä¸­ï¼š

* $W \in \mathbb{R}^{K \times d}$ï¼šæƒé‡çŸ©é˜µ
* $b \in \mathbb{R}^{K}$ï¼šåç½®å‘é‡
* $\hat{y} \in \mathbb{R}^{K}$ï¼šè¾“å‡ºä¸ºå±äºå„ç±»åˆ«çš„æ¦‚ç‡åˆ†å¸ƒ

---

## âœ… 3.2 è¾“å‡ºä¸çœŸå®æ ‡ç­¾çš„å·®è·å¦‚ä½•è¡¡é‡ï¼Ÿ

æˆ‘ä»¬éœ€è¦è®¾è®¡ä¸€ä¸ªæŸå¤±å‡½æ•°ï¼Œç”¨æ¥åº¦é‡ï¼š

> **æ¨¡å‹è¾“å‡º $\hat{y}$** å’Œ **çœŸå®æ ‡ç­¾ $y$** ä¹‹é—´çš„å·®è·æœ‰å¤šå¤§ï¼Ÿ

---

## âœ… 3.3 ä»€ä¹ˆæ˜¯äº¤å‰ç†µæŸå¤±ï¼ˆCross-Entropy Lossï¼‰ï¼Ÿ

å‡è®¾æ ‡ç­¾ $y \in \mathbb{R}^K$ æ˜¯ **one-hot ç¼–ç **ï¼š

* å¦‚æœçœŸå®ç±»åˆ«æ˜¯ç¬¬ 2 ç±»ï¼š

  $$
  y = [0, 1, 0, 0]
  $$

Softmax çš„è¾“å‡ºä¸ºæ¦‚ç‡å‘é‡ $\hat{y} = [0.1, 0.5, 0.2, 0.2]$

æˆ‘ä»¬è¦å¼ºè°ƒçš„ç›®æ ‡æ˜¯ï¼š**è®©æ­£ç¡®çš„é‚£ä¸€é¡¹ï¼ˆç¬¬2ä¸ªï¼‰æ¦‚ç‡è¶Šå¤§è¶Šå¥½**

---

### âœ… æŸå¤±å‡½æ•°å…¬å¼ï¼š

$$
L = - \sum_{i=1}^{K} y_i \log \hat{y}_i
$$

ç”±äº $y$ æ˜¯ one-hot ç¼–ç ï¼Œä¸Šé¢å¼å­å…¶å®åªä¿ç•™äº†**æ­£ç¡®ç±»åˆ«å¯¹åº”çš„ $\hat{y}_i$**ï¼š

$$
L = - \log (\hat{y}_{\text{true class}})
$$

---

### ğŸ“Œ ä¸¾ä¾‹ï¼š

* æ­£ç¡®ç±»åˆ«æ˜¯ç±» 2ï¼ŒSoftmax è¾“å‡ºï¼š

  $$
  \hat{y} = [0.1, \mathbf{0.7}, 0.1, 0.1]
  \Rightarrow L = -\log(0.7) \approx 0.357
  $$
* è‹¥æ¨¡å‹è¾“å‡ºé”™è¯¯çš„é¢„æµ‹ï¼š

  $$
  \hat{y} = [0.4, \mathbf{0.2}, 0.2, 0.2]
  \Rightarrow L = -\log(0.2) \approx 1.609
  $$

âœ… æ­£ç¡®é¢„æµ‹ â†’ æŸå¤±å°ï¼›é”™è¯¯é¢„æµ‹ â†’ æŸå¤±å¤§

![bg right:40% 90%](https://s.ar8.top/img/picgo/20250521185248423.webp)

---

## âœ… 3.4 ä¸ºä»€ä¹ˆé€‰ç”¨äº¤å‰ç†µæŸå¤±ï¼Ÿ

| ä¼˜ç‚¹            | è§£é‡Š                          |
| ------------- | --------------------------- |
| ğŸ¯ å¯¹æ¦‚ç‡åˆ†å¸ƒå»ºæ¨¡æ›´è‡ªç„¶ | Softmax è¾“å‡ºçš„æ˜¯æ¦‚ç‡ï¼Œäº¤å‰ç†µè¡¡é‡æ¦‚ç‡åˆ†å¸ƒé—´å·®è· |
| ğŸ“‰ å•è°ƒæƒ©ç½šé”™è¯¯é¢„æµ‹   | é¢„æµ‹è¶Šåç¦»çœŸå®æ ‡ç­¾ï¼ŒæŸå¤±è¶Šå¤§              |
| âœ… å¯å¯¼æ€§å¼º        | ä¸ Softmax è”ç”¨ï¼Œæ¢¯åº¦ç®€å•æ˜äº†ï¼Œè®­ç»ƒé«˜æ•ˆ    |
| ğŸŒ ä¸æœ€å¤§ä¼¼ç„¶ç­‰ä»·    | äº¤å‰ç†µç­‰ä»·äºæœ€å¤§åŒ–çœŸå®ç±»åˆ«çš„æ¦‚ç‡ï¼ˆæœ€å¤§ä¼¼ç„¶ä¼°è®¡ï¼‰    |

---

## âœ… å°ç»“

| é¡¹ç›®   | å†…å®¹                                  |
| ---- | ----------------------------------- |
| è¾“å…¥   | ç‰¹å¾å‘é‡ $x \in \mathbb{R}^d$           |
| è¾“å‡º   | ç±»åˆ«æ¦‚ç‡å‘é‡ $\hat{y} \in \mathbb{R}^K$   |
| æ¨¡å‹   | $\hat{y} = \text{Softmax}(Wx + b)$  |
| æ ‡ç­¾   | One-hot ç¼–ç å‘é‡                        |
| æŸå¤±å‡½æ•° | äº¤å‰ç†µ $L = - \sum y_i \log \hat{y}_i$ |

---

# ğŸ“ ç¬¬4èŠ‚ï¼šæ¢¯åº¦æ¨å¯¼ä¸å‚æ•°æ›´æ–°

---

## âœ… 4.1 æ¨¡å‹å›é¡¾

å¯¹äºæ¯ä¸ªæ ·æœ¬ $x_i \in \mathbb{R}^d$ï¼Œæˆ‘ä»¬é¢„æµ‹ï¼š

$$
\hat{y}_i = \text{Softmax}(W x_i + b) \in \mathbb{R}^K
$$

å¯¹åº”çš„äº¤å‰ç†µæŸå¤±ä¸ºï¼š

$$
L = -\frac{1}{n} \sum_{i=1}^{n} \sum_{j=1}^{K} y_{ij} \log \hat{y}_{ij}
$$

* $Y \in \mathbb{R}^{n \times K}$ï¼šçœŸå®æ ‡ç­¾çš„ one-hot ç¼–ç çŸ©é˜µ
* $\hat{Y} \in \mathbb{R}^{n \times K}$ï¼šæ¨¡å‹é¢„æµ‹è¾“å‡º

---

## âœ… 4.2 å¯¹æƒé‡ $W$ çš„æ¢¯åº¦æ¨å¯¼

$$
L = -\frac{1}{n} \sum_{i=1}^{n} \sum_{j=1}^{K} y_{ij} \log \hat{y}_{ij}
$$

ä½¿ç”¨é“¾å¼æ³•åˆ™ï¼Œæœ€ç»ˆå¯ä»¥å¾—åˆ°ï¼š

$$
\nabla_W = \frac{1}{n} X^T (\hat{Y} - Y)
$$

* $X \in \mathbb{R}^{n \times d}$ï¼šè¾“å…¥ç‰¹å¾çŸ©é˜µ
* $\hat{Y} - Y \in \mathbb{R}^{n \times K}$ï¼šé¢„æµ‹è¯¯å·®
* $\nabla_W \in \mathbb{R}^{d \times K}$

> æ¯ä¸€è¡Œæ ·æœ¬ $x_i$ éƒ½ä¼šå¯¹é¢„æµ‹è¯¯å·® $(\hat{y}_i - y_i)$ é€ æˆå½±å“ï¼Œæ¢¯åº¦æ˜¯æ‰€æœ‰æ ·æœ¬å¯¹ $W$ çš„ç´¯è®¡å¯¼æ•°ã€‚

---

## âœ… 4.3 å¯¹åç½® $b$ çš„æ¢¯åº¦

ç±»ä¼¼åœ°ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°ï¼š

$$
\nabla_b = \frac{1}{n} \sum_{i=1}^{n} (\hat{y}_i - y_i)
$$

æˆ–å‘é‡å½¢å¼ï¼š

$$
\nabla_b = \frac{1}{n} \sum_{i=1}^{n} (\hat{Y} - Y) \in \mathbb{R}^K
$$

---

## âœ… 4.4 æ¢¯åº¦ä¸‹é™æ›´æ–°å…¬å¼

ä½¿ç”¨å­¦ä¹ ç‡ $\alpha$ï¼Œæ¯æ¬¡æ›´æ–°ï¼š

$$
W := W - \alpha \cdot \nabla_W
\quad
$$
$$
\quad
b := b - \alpha \cdot \nabla_b
$$

---

## âœ… 4.5 ä¸é€»è¾‘å›å½’çš„æ¯”è¾ƒ

| é¡¹ç›®   | é€»è¾‘å›å½’                | Softmax å›å½’          |
| ---- | ------------------- | ------------------- |
| è¾“å‡ºç»´åº¦ | æ ‡é‡ï¼ˆ1 ä¸ªæ¦‚ç‡ï¼‰           | å‘é‡ï¼ˆK ä¸ªæ¦‚ç‡ï¼‰           |
| æ ‡ç­¾æ ¼å¼ | æ ‡é‡ï¼ˆ0/1ï¼‰             | One-hot å‘é‡          |
| æŸå¤±å‡½æ•° | å¯¹æ•°æŸå¤±                | äº¤å‰ç†µæŸå¤±               |
| æ¢¯åº¦è¡¨è¾¾ | $X^T (\hat{y} - y)$ | $X^T (\hat{Y} - Y)$ |

âœ… æ‰€ä»¥ç»“æ„å‡ ä¹ä¸€è‡´ï¼Œé€»è¾‘å›å½’å°±æ˜¯ Softmax çš„äºŒç»´ç‰ˆæœ¬ï¼

---

# ğŸ“ ç¬¬5èŠ‚ï¼šä½¿ç”¨ NumPy æ‰‹åŠ¨å®ç°çš„ Softmax å¤šåˆ†ç±»æ¨¡å‹è®­ç»ƒè¿‡ç¨‹

---

![](https://s.ar8.top/img/picgo/20250521192842701.webp)

---

### ğŸ“å·¦å›¾ï¼šSoftmax åˆ†ç±»å™¨çš„å†³ç­–è¾¹ç•Œ

* èƒŒæ™¯åŒºåŸŸè¢«é¢œè‰²åˆ†æˆ 3 ç±»ï¼š

  * çº¢è‰²ã€è“è‰²ã€æµ…è‰²åˆ†åˆ«è¡¨ç¤ºæ¨¡å‹é¢„æµ‹ä¸ºç±»åˆ« 0ã€1ã€2 çš„åŒºåŸŸ
* ä¸­å¿ƒç‚¹æ˜¯è®­ç»ƒæ ·æœ¬ï¼Œé¢œè‰²è¡¨ç¤ºå…¶çœŸå®ç±»åˆ«ï¼ˆå…± 3 ç±»ï¼‰
* ä¸­é—´çš„æ›²çº¿æ˜¯ä¸åŒç±»åˆ«é—´çš„å†³ç­–è¾¹ç•Œï¼Œä½“ç°å‡º Softmax å¯¹å¤šåˆ†ç±»çš„å¤„ç†èƒ½åŠ›

---

### ğŸ“‰å³å›¾ï¼šè®­ç»ƒè¿‡ç¨‹ä¸­äº¤å‰ç†µæŸå¤±çš„ä¸‹é™æ›²çº¿

* æ˜¾ç¤ºäº†è®­ç»ƒä¸­æŸå¤±å‡½æ•°é€æ­¥å‡å°
* æ¨¡å‹æ­£åœ¨ä¸æ–­è°ƒæ•´å‚æ•°ï¼Œä»¥æ›´å¥½æ‹Ÿåˆæ•°æ®

---

### âœ… æœ¬èŠ‚å®ç°å†…å®¹ï¼š

* ç”Ÿæˆ 3 ç±»å¯åˆ†æ•°æ®
* æ„å»º Softmax å‰å‘ä¼ æ’­ä¸äº¤å‰ç†µæŸå¤±å‡½æ•°
* ä½¿ç”¨ NumPy å®ç°å¤šåˆ†ç±»çš„æ¢¯åº¦ä¸‹é™è®­ç»ƒ
* å¯è§†åŒ–å†³ç­–è¾¹ç•Œä¸è®­ç»ƒè¿‡ç¨‹

---

# ğŸ“ ç¬¬6èŠ‚ï¼šæ€»ç»“ + å¤šåˆ†ç±»çš„æ‰©å±•æ–¹å‘

---

## âœ… 6.1 çŸ¥è¯†å›é¡¾è¡¨

| é¡¹ç›®   | é€»è¾‘å›å½’                          | Softmax å›å½’                        |
| ---- | ----------------------------- | --------------------------------- |
| ä»»åŠ¡ç±»å‹ | äºŒåˆ†ç±»                           | å¤šåˆ†ç±»ï¼ˆäº’æ–¥ç±»åˆ«ï¼‰                         |
| æ¿€æ´»å‡½æ•° | Sigmoid                       | Softmax                           |
| è¾“å‡ºç»´åº¦ | æ ‡é‡ï¼ˆæ¦‚ç‡ï¼‰                        | K ç»´æ¦‚ç‡å‘é‡                           |
| è¾“å‡ºèŒƒå›´ | $(0, 1)$                      | $(0, 1)^K$ï¼Œä¸” $\sum \hat{y}_i = 1$ |
| æŸå¤±å‡½æ•° | å¯¹æ•°æŸå¤±ï¼ˆLog Lossï¼‰                | äº¤å‰ç†µæŸå¤±ï¼ˆCross Entropy Lossï¼‰         |
| é¢„æµ‹æ–¹å¼ | $\hat{y} > 0.5 \Rightarrow 1$ | $\hat{y} = \arg\max_i \hat{y}_i$  |


---

## âœ… 6.2 Softmax è¾“å‡ºæ˜¯å¦å¯ä»¥çœ‹ä½œâ€œæ¦‚ç‡â€ï¼Ÿ

ç­”æ¡ˆæ˜¯ï¼š**å¯ä»¥ï¼Œä½†æœ‰å‰æã€‚**

### ğŸ§  åŸå› ï¼š

* Softmax è¾“å‡ºçš„æ¯ä¸€é¡¹éƒ½åœ¨ 0\~1 ä¹‹é—´
* æ‰€æœ‰è¾“å‡ºåŠ èµ·æ¥ç­‰äº 1

### ğŸ“Œ æ³¨æ„ï¼š

* å®ƒæ˜¯â€œæ¨¡å‹è®¤ä¸ºå±äºè¯¥ç±»çš„ç›¸å¯¹ä¿¡å¿ƒâ€
* ä¸¥æ ¼æ¥è¯´ï¼Œä¸æ˜¯**ç»Ÿè®¡æ¦‚ç‡**ï¼Œä½†å¯ä»¥ä½œä¸ºæ¦‚ç‡è¿‘ä¼¼ä½¿ç”¨
* åœ¨å¤šæ•°åˆ†ç±»ä»»åŠ¡ä¸­ï¼Œæˆ‘ä»¬ç”¨å®ƒæ¥ï¼š

  * é€‰å‡ºæœ€å¤§å€¼ä½œä¸ºé¢„æµ‹ç±»åˆ«
  * åˆ†æ•°è¶Šé«˜ï¼Œæ¨¡å‹è¶Šâ€œè‡ªä¿¡â€

---

## âœ… 6.3 æ¨¡å‹æ˜¯å¦å¯ä»¥å¤„ç†å¤šæ ‡ç­¾åˆ†ç±»ï¼Ÿ

ç›®å‰æˆ‘ä»¬æ‰€è®²çš„ Softmax æ˜¯é’ˆå¯¹**äº’æ–¥ç±»åˆ«ï¼ˆmulti-classï¼‰**ï¼š

* ä¸€å¼ å›¾ç‰‡åªèƒ½æ˜¯â€œç‹—â€æˆ–â€œçŒ«â€ï¼Œä¸èƒ½åŒæ—¶æ˜¯
* ğŸ“· ä¸€å¼ å›¾ç‰‡å¯ä»¥åŒæ—¶åŒ…å«â€œç‹—â€+â€œäººâ€+â€œè½¦â€

âœ… è¿™ç±»ä»»åŠ¡å«åšï¼š**å¤šæ ‡ç­¾åˆ†ç±»ï¼ˆmulti-label classificationï¼‰**

### âŒ Softmax ä¸é€‚ç”¨

* å› ä¸ºå®ƒè¦æ±‚æ‰€æœ‰è¾“å‡ºä¹‹å’Œä¸º 1
* å¤šæ ‡ç­¾ä»»åŠ¡ä¸èƒ½å¼ºè¿«ç±»åˆ«ä¹‹é—´ç«äº‰

### âœ… ç”¨æ³•æ›¿ä»£ï¼š

* æ¯ä¸ªè¾“å‡ºèŠ‚ç‚¹ä½¿ç”¨ **sigmoid** ä»£æ›¿ Softmax
* ä½¿ç”¨ **å¤šé‡å¯¹æ•°æŸå¤±**ï¼Œå¯¹æ¯ä¸ªæ ‡ç­¾å•ç‹¬è®¡ç®— loss

---

## âœ… 6.4 Softmax çš„å·¥ç¨‹æ‰©å±•åº”ç”¨

| åº”ç”¨é¢†åŸŸ    | è¯´æ˜                 |
| ------- | ------------------ |
| å›¾åƒåˆ†ç±»    | è¾“å‡ºå±äºå¤šä¸ªè§†è§‰ç±»åˆ«çš„æ¦‚ç‡      |
| æ–‡æœ¬æƒ…æ„Ÿåˆ†æ  | æ­£å‘ / è´Ÿå‘ / ä¸­æ€§åˆ†ç±»     |
| è¯­éŸ³å‘½ä»¤è¯†åˆ«  | å¤šç§æŒ‡ä»¤æ„å›¾åˆ†ç±»           |
| OCRå­—ç¬¦è¯†åˆ« | è¾“å‡ºæœ€å¯èƒ½çš„å­—ç¬¦æ ‡ç­¾ï¼ˆa \~ zï¼‰ |

---

## ğŸ§  æœ¬è¯¾æ€»ç»“ï¼š

* ä½ ç°åœ¨å¯ä»¥æ¸…æ¥šåœ°åŒºåˆ† **é€»è¾‘å›å½’ vs Softmax å›å½’**
* æŒæ¡äº† Softmax å‡½æ•°çš„å®šä¹‰ä¸æ€§è´¨
* ç†è§£äº†å¤šç±»äº¤å‰ç†µæŸå¤±å‡½æ•°ï¼Œå¹¶ä¼šæ‰‹åŠ¨å®ç°è®­ç»ƒè¿‡ç¨‹
* å·²ç»èƒ½é€šè¿‡ NumPy å®ç°å®Œæ•´å¤šåˆ†ç±»è®­ç»ƒä¸å¯è§†åŒ–
* å¯¹å¤šæ ‡ç­¾ã€å¤šç±»ã€ç¥ç»ç½‘ç»œåˆ†ç±»ä»»åŠ¡æœ‰äº†ç›´è§‰è®¤è¯†

---

**ä¸‹ä¸€èŠ‚é¢„å‘Šï¼š**
> ğŸ” ç¥ç»ç½‘ç»œåŸºç¡€ï¼ˆå¤šå±‚æ„ŸçŸ¥æœºï¼ŒMLPï¼‰