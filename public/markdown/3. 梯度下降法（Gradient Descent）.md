---
marp: true
theme: default
paginate: true
math: katex
---

<style>
section {
  font-family: "Microsoft YaHei", "PingFang SC", "Source Han Sans", "Noto Sans CJK SC", sans-serif;
}
</style>

## <!-- fit -->ğŸ“˜ ç¬¬3è®²ï¼šæ¢¯åº¦ä¸‹é™æ³•ï¼ˆGradient Descentï¼‰

---

## âœ… 1. åœºæ™¯å¼•å…¥ï¼šä»â€œä¸‹å±±â€è®²èµ·

### ğŸ§  å¼•å¯¼é—®é¢˜ï¼š

> â€œå‡è®¾ä½ ç«™åœ¨ä¸€åº§å±±çš„å±±é¡¶ï¼Œå¤©æ°”å¤ªå·®çœ‹ä¸åˆ°å‘¨å›´ï¼Œä½ è¯¥æ€ä¹ˆèµ°æ‰èƒ½å°½å¿«èµ°åˆ°å±±è„šä¸‹ï¼Ÿâ€

---

### ğŸ¯ å¼•å…¥ç±»æ¯”ï¼š

- ä½ å¤„åœ¨ä¸€ä¸ª**å¤æ‚çš„åœ°å½¢å‡½æ•°**ä¸Šï¼Œæ¯ä¸ªç‚¹éƒ½æœ‰ä¸€ä¸ªâ€œé«˜åº¦â€ã€‚
- ä½ æ‰‹é‡Œæ²¡æœ‰åœ°å›¾ï¼Œä½†ä½ èƒ½ç”¨è„šæ„ŸçŸ¥â€œå“ªé‡Œæ›´é™¡â€ã€‚
- æ‰€ä»¥ä½ é‡‡å–çš„ç­–ç•¥æ˜¯ï¼š
  - **æ„ŸçŸ¥å½“å‰ä½ç½®çš„å¡åº¦æ–¹å‘ï¼ˆå¯¼æ•°ï¼‰**
  - **æ²¿æœ€é™¡çš„æ–¹å‘å¾€ä¸‹èµ°ä¸€ç‚¹**
  - **ä¸æ–­é‡å¤**

---

### ğŸ“Œ ç±»æ¯”è½¬åŒ–ï¼š

| ç™»å±±é—®é¢˜ | æœºå™¨å­¦ä¹ é—®é¢˜ |
|----------|----------------|
| å±±çš„é«˜åº¦ | æŸå¤±å‡½æ•°å€¼ |
| å½“å‰æ‰€åœ¨ç‚¹ | å½“å‰æ¨¡å‹å‚æ•°ï¼ˆå¦‚ $w, b$ï¼‰|
| å¾€ä¸‹èµ° | å‡å°‘æŸå¤± |
| å¡åº¦æ–¹å‘ | æ¢¯åº¦ |
| æ¯æ¬¡è¿ˆå‡ºæ­¥ | å‚æ•°æ›´æ–° |
| ä¸‹å±±æˆåŠŸ | æ‰¾åˆ°æœ€ä¼˜è§£ï¼ˆæœ€å°æŸå¤±ï¼‰ |

![bg right:45% 100%](https://s.ar8.top/img/picgo/20250429225534445.webp)

---

### ğŸ”‘ å°ç»“ï¼š

> â€œè¿™å°±æ˜¯**æ¢¯åº¦ä¸‹é™æ³•**çš„åŸºæœ¬æ€æƒ³ï¼š**è®©æ¨¡å‹é¡ºç€æŸå¤±å‡½æ•°çš„æ¢¯åº¦ä¸æ–­â€˜ä¸‹é™â€™ï¼Œç›´åˆ°æ‰¾åˆ°æœ€ä¼˜è§£ã€‚**â€

---

## âœ… 2. ä»€ä¹ˆæ˜¯â€œæ¢¯åº¦â€ï¼Ÿ

---

### âœ¨ 2.1 åœ¨ä¸€ç»´ç©ºé—´ä¸­ï¼ˆå¯¼æ•°ï¼‰

- å¦‚æœä½ åœ¨å­¦å¾®ç§¯åˆ†æ—¶å­¦è¿‡å¯¼æ•°ï¼š
   $$
    f'(x) = \frac{d}{dx} f(x)
   $$
  - å®ƒè¡¨ç¤ºå‡½æ•°åœ¨æŸä¸€ç‚¹çš„â€œæ–œç‡â€ã€‚
- æ¢¯åº¦ä¸‹é™ä¸­çš„â€œæ¢¯åº¦â€å°±æ˜¯å¯¼æ•°ï¼š
  - å¦‚æœå‡½æ•°æ˜¯ $f(x) = (x-3)^2$ï¼Œé‚£ä¹ˆï¼š
   $$
    f'(x) = 2(x - 3)
   $$
    å½“å‰ $x$ è¶Šå¤§ï¼Œæ–œç‡è¶Šå¤§
- ä½ è¦åšçš„å°±æ˜¯ **æ²¿ç€è´Ÿæ–œç‡æ–¹å‘æ›´æ–° $x$**ï¼Œé€æ¸é è¿‘æœ€ä½ç‚¹ã€‚

---

### ğŸ§­ ä¸€ç»´æ¢¯åº¦ä¸‹é™è¿‡ç¨‹ï¼š

- åˆå§‹å€¼ $x_0 = 0$
- å­¦ä¹ ç‡ $\alpha = 0.1$
- æ›´æ–°å…¬å¼ï¼š
 $$
  x_{t+1} = x_t - \alpha \cdot f'(x_t)
 $$

| t | $x_t$ | $f'(x_t)$ | $x_{t+1}$ |
|---|-----------|----------------|----------------|
| 0 | 0         | -6             | 0.6            |
| 1 | 0.6       | -4.8           | 1.08           |
| 2 | 1.08      | -3.84          | 1.464          |
| â€¦ | â€¦         | â€¦              | â€¦              |

âœ… æœ€ç»ˆæ”¶æ•›åˆ° $x = 3$ï¼ˆæœ€å°å€¼ç‚¹ï¼‰

---

### ğŸ“ 2.2 åœ¨å¤šç»´ç©ºé—´ä¸­ï¼ˆå‘é‡æ¢¯åº¦ï¼‰

å¦‚æœæˆ‘ä»¬æœ‰ä¸€ä¸ªå‡½æ•°ï¼š

$$
f(w, b) = \frac{1}{n} \sum_{i=1}^{n} (y_i - (wx_i + b))^2
$$

- $w, b$ æ˜¯æˆ‘ä»¬è¦ä¼˜åŒ–çš„â€œä½ç½®â€
- æ¢¯åº¦æ˜¯ä¸€ä¸ª**å‘é‡**ï¼Œæ¯ä¸ªç»´åº¦éƒ½å‘Šè¯‰æˆ‘ä»¬â€œè¿™ä¸€æ–¹å‘ä¸Šçš„æœ€é™¡ä¸Šå‡æ–¹å‘â€

å¤šç»´æ›´æ–°å…¬å¼ï¼š

$$
\boldsymbol{\theta}_{t+1} = \boldsymbol{\theta}_t - \alpha \cdot \nabla_{\boldsymbol{\theta}} f(\boldsymbol{\theta}_t)
$$

å…¶ä¸­ $\boldsymbol{\theta} = [w, b]$

---

### ğŸ“Œ æ¢¯åº¦ä¸‹é™çš„ç›´è§‚ç†è§£


å¯¹$\theta$èµ‹å€¼ï¼Œä½¿å¾—$f(\boldsymbol{\theta}_t)$æŒ‰æ¢¯åº¦ä¸‹é™æœ€å¿«æ–¹å‘è¿›è¡Œï¼Œä¸€ç›´è¿­ä»£ä¸‹å»ï¼Œæœ€ç»ˆå¾—åˆ°å±€éƒ¨æœ€å°å€¼ã€‚å…¶ä¸­$\alpha$æ˜¯å­¦ä¹ ç‡ï¼ˆlearning rateï¼‰ï¼Œå®ƒå†³å®šäº†æˆ‘ä»¬æ²¿ç€èƒ½è®©ä»£ä»·å‡½æ•°ä¸‹é™ç¨‹åº¦æœ€å¤§çš„æ–¹å‘å‘ä¸‹è¿ˆå‡ºçš„æ­¥å­æœ‰å¤šå¤§ã€‚
å¯¹äºè¿™ä¸ªé—®é¢˜ï¼Œæ±‚å¯¼çš„ç›®çš„ï¼ŒåŸºæœ¬ä¸Šå¯ä»¥è¯´å–è¿™ä¸ªçº¢ç‚¹çš„åˆ‡çº¿ï¼Œå°±æ˜¯è¿™æ ·ä¸€æ¡çº¢è‰²çš„ç›´çº¿ï¼Œåˆšå¥½ä¸å‡½æ•°ç›¸åˆ‡äºè¿™ä¸€ç‚¹ï¼Œè®©æˆ‘ä»¬çœ‹çœ‹è¿™æ¡çº¢è‰²ç›´çº¿çš„æ–œç‡ï¼Œå°±æ˜¯è¿™æ¡åˆšå¥½ä¸å‡½æ•°æ›²çº¿ç›¸åˆ‡çš„è¿™æ¡ç›´çº¿ï¼Œè¿™æ¡ç›´çº¿çš„æ–œç‡æ­£å¥½æ˜¯è¿™ä¸ªä¸‰è§’å½¢çš„é«˜åº¦é™¤ä»¥è¿™ä¸ªæ°´å¹³é•¿åº¦ï¼Œç°åœ¨ï¼Œè¿™æ¡çº¿æœ‰ä¸€ä¸ªæ­£æ–œç‡ï¼Œä¹Ÿå°±æ˜¯è¯´å®ƒæœ‰æ­£å¯¼æ•°ï¼Œå› æ­¤ï¼Œæˆ‘å¾—åˆ°çš„æ–°çš„$\theta_1$ï¼Œ$\theta_1$æ›´æ–°åç­‰äº$\theta_1$å‡å»ä¸€ä¸ªæ­£æ•°ä¹˜ä»¥$\alpha$ã€‚

![50% 90%](https://s.ar8.top/img/picgo/20250430000057416.webp)


---

### âœ… å°ç»“ï¼š

> â€œæ¢¯åº¦æ˜¯å‘Šè¯‰æˆ‘ä»¬è¯¥å¾€å“ªèµ°çš„æŒ‡å—é’ˆï¼Œæ¢¯åº¦ä¸‹é™æ˜¯æ ¹æ®è¿™ä¸ªæŒ‡å—é’ˆï¼Œèµ°å‘æŸå¤±å‡½æ•°æœ€å°å€¼çš„è¿‡ç¨‹ã€‚â€

---


# âœ… 3. æ¢¯åº¦ä¸‹é™çš„å·¥ä½œæœºåˆ¶

### ğŸ§­ 3.1 æ¢¯åº¦ä¸‹é™æµç¨‹å›¾ï¼ˆ5 æ­¥ï¼‰

æˆ‘ä»¬ç”¨ä¼ªä»£ç /å›¾è§£æ–¹å¼å±•ç¤ºå®Œæ•´æµç¨‹ï¼š

```
1. åˆå§‹åŒ–å‚æ•°ï¼ˆå¦‚ w, bï¼‰
2. é‡å¤æ‰§è¡Œä»¥ä¸‹æ­¥éª¤ï¼Œç›´åˆ°æ”¶æ•›ï¼š
   a. ä½¿ç”¨å½“å‰å‚æ•°è®¡ç®—é¢„æµ‹å€¼ y_hat
   b. è®¡ç®—æŸå¤±å‡½æ•° L(w, b)
   c. å¯¹å‚æ•°æ±‚å¯¼ï¼Œå¾—åˆ°æ¢¯åº¦ âˆ‡L
   d. æŒ‰æ¢¯åº¦çš„åæ–¹å‘æ›´æ–°å‚æ•°
```

---

### ğŸ“‰ 3.2 æ•°å­¦æ›´æ–°è§„åˆ™ï¼ˆä»¥çº¿æ€§å›å½’ä¸ºä¾‹ï¼‰

#### å‡è®¾æ¨¡å‹ï¼š

$$
\hat{y}_i = wx_i + b
$$

#### æŸå¤±å‡½æ•°ï¼ˆå‡æ–¹è¯¯å·®ï¼‰ï¼š

$$
L(w, b) = \frac{1}{n} \sum_{i=1}^{n} (y_i - \hat{y}_i)^2
= \frac{1}{n} \sum_{i=1}^{n} (y_i - wx_i - b)^2
$$

---

#### æ±‚å¯¼ï¼ˆåå¯¼ï¼‰ï¼š

$$
\frac{\partial L}{\partial w} = -\frac{2}{n} \sum x_i (y_i - \hat{y}_i)
$$
$$
\frac{\partial L}{\partial b} = -\frac{2}{n} \sum (y_i - \hat{y}_i)
$$

---

#### æ›´æ–°è§„åˆ™ï¼š

$$
w := w - \alpha \cdot \frac{\partial L}{\partial w}
\quad\quad
b := b - \alpha \cdot \frac{\partial L}{\partial b}
$$

å…¶ä¸­ï¼š

- $\alpha$ï¼šå­¦ä¹ ç‡ï¼ˆlearning rateï¼‰ï¼Œæ§åˆ¶æ¯ä¸€æ­¥â€œèµ°å¤šå°‘â€
- $n$ï¼šæ ·æœ¬æ•°é‡

---

### ğŸ“Œ 3.3 è¶…å‚æ•°çš„ä½œç”¨

#### ğŸ”§ å­¦ä¹ ç‡ $\alpha$

- å¤ªå°ï¼šæ”¶æ•›å¤ªæ…¢ï¼Œè¦èµ°å¾ˆå¤šæ­¥
- å¤ªå¤§ï¼šå¯èƒ½éœ‡è¡ç”šè‡³å‘æ•£ï¼ˆè·³è¿‡æœ€ä¼˜ç‚¹ï¼‰

âœ… æœ€ä½³åšæ³•ï¼š**é€‚ä¸­ï¼Œå¹¶åŠ¨æ€è°ƒæ•´æˆ–ä½¿ç”¨å­¦ä¹ ç‡è¡°å‡**

---

#### ğŸ” è¿­ä»£æ¬¡æ•°ï¼ˆEpochï¼‰

- æ¯ä¸€ä¸ª epoch = ç”¨æ‰€æœ‰æ ·æœ¬å®Œæˆä¸€æ¬¡å‚æ•°æ›´æ–°
- é€šå¸¸å¾ªç¯å¤šæ¬¡ï¼ˆå‡ åã€å‡ ç™¾ç”šè‡³å‡ åƒæ¬¡ï¼‰ç›´åˆ°ï¼š
  - æ”¶æ•›ï¼ˆloss å˜åŒ–å¾ˆå°ï¼‰
  - è¾¾åˆ°æœ€å¤§è¿­ä»£æ¬¡æ•°

---

### ğŸ§  3.4 æ¢¯åº¦ä¸‹é™çš„ç›´è§‰æ€»ç»“

> æ¢¯åº¦ä¸‹é™å°±åƒâ€œé—­ç€çœ¼ç›æ²¿æ–œå¡èµ°å‘è°·åº•â€çš„è¿‡ç¨‹ï¼š

- æ¢¯åº¦å‘Šè¯‰ä½ æ–¹å‘ï¼ˆé™¡å¡ï¼‰
- å­¦ä¹ ç‡å†³å®šä½ æ¯æ¬¡è¿ˆå¤šè¿œ
- å¤šæ¬¡èµ°åŠ¨ä¹‹åï¼Œä½ è¶Šæ¥è¶Šé è¿‘æœ€ä½ç‚¹

---

# âœ… 4. æ¢¯åº¦ä¸‹é™åœ¨çº¿æ€§å›å½’ä¸­çš„å®ä¾‹åº”ç”¨ï¼ˆæ‰‹ç®—ä¸€è½®ï¼‰

ä¸€å…ƒçº¿æ€§å›å½’æ–¹ç¨‹
$$
\hat{y}_i = wx_i + b
$$

ç»™å®šåˆå§‹ï¼š

- $w = 0$, $b = 0$
- å•ä¸ªæ ·æœ¬ $(x=2, y=10)$
- å­¦ä¹ ç‡ $\alpha = 0.1$

è®¡ç®—é¢„æµ‹å€¼ï¼š

$$
\hat{y} = 0 \cdot 2 + 0 = 0
$$

---

è®¡ç®—è¯¯å·®ï¼š

$$
e = y - \hat{y} = 10 - 0 = 10
$$

è®¡ç®—æ¢¯åº¦ï¼š

$$
\frac{\partial L}{\partial w} = -2x \cdot e = -2 \cdot 2 \cdot 10 = -40
\quad\Rightarrow\quad w := 0 - 0.1 \cdot (-40) = 4.0
$$

$$
\frac{\partial L}{\partial b} = -2 \cdot e = -20
\quad\Rightarrow\quad b := 0 - 0.1 \cdot (-20) = 2.0
$$

âœ… ä¸€æ¬¡æ›´æ–°åï¼Œ$w = 4, b = 2$ï¼Œæ¨¡å‹å·²é€¼è¿‘æ­£ç¡®ç»“æœï¼

---


## ğŸ“Œ å°ç»“

| å†…å®¹ | è¦ç‚¹ |
|------|------|
| æŸå¤±å‡½æ•° | æœ€å°åŒ– $(y - \hat{y})^2$ |
| æ¢¯åº¦ | æ˜¯è¯¯å·®å¯¹å‚æ•°çš„å¯¼æ•° |
| æ›´æ–°è§„åˆ™ | $\theta := \theta - \alpha \cdot \nabla_\theta$ |
| ä¼˜åŠ¿ | ä¸éœ€è¦çŸ©é˜µæ±‚é€†ï¼Œé€‚åˆå¤§æ•°æ®ã€å¤§ç‰¹å¾é‡ |

---

# âœ… ç¬¬ 5 éƒ¨åˆ†ï¼šä½¿ç”¨ NumPy å®ç°æ¢¯åº¦ä¸‹é™æ±‚è§£çº¿æ€§å›å½’

## ğŸ§© æ¨¡æ‹Ÿæ•°æ®ï¼ˆè®­ç»ƒæ•°æ®ï¼‰

æˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ªç®€å•çš„çº¿æ€§æ•°æ®é›†ï¼ˆé¢ç§¯ + æ¥¼å±‚ â†’ æˆ¿ä»·ï¼‰ï¼š
å¤–éƒ¨å‚è€ƒ

---

## ğŸ“Œ æ€»ç»“

| é¡¹ç›® | è¯´æ˜ |
|------|------|
| æ¢¯åº¦è®¡ç®— | æ˜¯å…³é”®æ­¥éª¤ï¼šé€šè¿‡è¯¯å·®åå‘ä¼ æ’­ |
| æƒé‡æ›´æ–° | æ ¹æ®æ¢¯åº¦åæ–¹å‘ã€ä¹˜å­¦ä¹ ç‡è°ƒæ•´ |
| æ”¶æ•›åˆ¤æ–­ | å¯é€šè¿‡æŸå¤±æ˜¯å¦è¶‹äºç¨³å®šæ¥è§‚å¯Ÿ |
| å¯è§£é‡Šæ€§ | æ¨¡å‹å­¦å‡ºçš„æ¯ä¸ªæƒé‡éƒ½æœ‰æ˜ç¡®ç‰©ç†æ„ä¹‰ |

---

**ä¸‹ä¸€èŠ‚é¢„å‘Šï¼š**
> ğŸ” é€»è¾‘å›å½’é—®é¢˜